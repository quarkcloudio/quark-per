!function(){"use strict";function e(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}}function t(e){return function(t){return typeof t===e}}function n(){}function r(e){return function(){return e}}function o(e){return e}function i(e,t){return e===t}function a(e){return function(t){return!e(t)}}function s(){return h}var u=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=e("string"),f=e("object"),d=e("array"),l=t("boolean"),m=t("function"),p=t("number"),g=r(!1),v=r(!0),h={fold:function(e,t){return e()},isSome:g,isNone:v,getOr:o,getOrThunk:y,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:y,map:s,each:n,bind:s,exists:g,forall:v,filter:function(){return h},toArray:function(){return[]},toString:r("none()")};function y(e){return e()}function S(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r}function C(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function b(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}function N(e,t,n){return C(e,(function(e,r){n=t(n,e,r)})),n}function O(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return E.some(i);if(n(i,r))break}return E.none()}function L(e,t){return O(e,t,g)}function T(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!d(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);P.apply(t,e[n])}return t}(S(e,t))}function D(e){var t=I.call(e,0);return t.reverse(),t}function x(e,t){return 0<=t&&t<e.length?E.some(e[t]):E.none()}function A(e){return x(e,0)}function w(e){return x(e,e.length-1)}var k=function(e){function t(){return i}function n(t){return t(e)}var o=r(e),i={fold:function(t,n){return n(e)},isSome:v,isNone:g,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return k(t(e))},each:function(t){t(e)},bind:n,exists:n,forall:n,filter:function(t){return t(e)?i:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},E={some:k,none:s,from:function(e){return null==e?h:k(e)}},I=Array.prototype.slice,P=Array.prototype.push,B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function R(e,t){return function(t){for(var n=0;n<t.length;n++){var r=function(t){var n=t.brand.toLowerCase();return L(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:G.nu(parseInt(t.version,10),0)}}))}(t[n]);if(r.isSome())return r}return E.none()}(t.brands)}function M(e,t){var n=String(t).toLowerCase();return L(e,(function(e){return e.search(n)}))}function U(e,t){return-1!==e.indexOf(t)}function _(e){return function(t){return U(t,e)}}function $(e){return window.matchMedia(e).matches}function F(e,t){return e.dom===t.dom}function H(e,t){return le().browser.isIE()?(n=e.dom,r=t.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(n.compareDocumentPosition(r)&o)):(i=e.dom)!==(a=t.dom)&&i.contains(a);var n,r,o,i,a}function j(e,t){for(var n=ye(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}}function K(){return Z(0,0)}function V(e){function t(e){return function(){return n===e}}var n=e.current,r=e.version;return{current:n,version:r,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t(ne),isSafari:t("Safari")}}function W(e){function t(e){return function(){return n===e}}var n=e.current,r=e.version;return{current:n,version:r,isWindows:t(ie),isiOS:t("iOS"),isAndroid:t(ae),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t(se),isFreeBSD:t(ue),isChromeOS:t(ce)}}function Q(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}var X,q,z,Y,Z=function(e,t){return{major:e,minor:t}},G={nu:Z,detect:function(e,t){var n,r,o=String(t).toLowerCase();return 0===e.length?K():(r=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,n=o))?Z(i(1),i(2)):{major:0,minor:0};function i(e){return Number(n.replace(r,"$"+e))}},unknown:K},J=(X=/^\s+|\s+$/g,function(e){return e.replace(X,"")}),ee=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,te={browsers:r([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return U(e,"edge/")&&U(e,"chrome")&&U(e,"safari")&&U(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ee],search:function(e){return U(e,"chrome")&&!U(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return U(e,"msie")||U(e,"trident")}},{name:"Opera",versionRegexes:[ee,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:_("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:_("firefox")},{name:"Safari",versionRegexes:[ee,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(U(e,"safari")||U(e,"mobile/"))&&U(e,"applewebkit")}}]),oses:r([{name:"Windows",search:_("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return U(e,"iphone")||U(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:_("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:_("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:_("linux"),versionRegexes:[]},{name:"Solaris",search:_("sunos"),versionRegexes:[]},{name:"FreeBSD",search:_("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:_("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},ne="Firefox",re=function(){return V({current:void 0,version:G.unknown()})},oe=V,ie=(r("Edge"),r("Chrome"),r("IE"),r("Opera"),r(ne),r("Safari"),"Windows"),ae="Android",se="Solaris",ue="FreeBSD",ce="ChromeOS",fe=function(){return W({current:void 0,version:G.unknown()})},de=W,le=(r(ie),r("iOS"),r(ae),r("Linux"),r("OSX"),r(se),r(ue),r(ce),Y=!(q=function(){return e=navigator.userAgent,t=E.from(navigator.userAgentData),n=$,v=te.browsers(),h=te.oses(),y=t.bind((function(e){return R(v,e)})).orThunk((function(){return M(v,t=e).map((function(e){var n=G.detect(e.versionRegexes,t);return{current:e.name,version:n}}));var t})).fold(re,oe),S=M(h,o=e).map((function(e){var t=G.detect(e.versionRegexes,o);return{current:e.name,version:t}})).fold(fe,de),{browser:y,os:S,deviceType:(a=y,s=e,u=n,c=(i=S).isiOS()&&!0===/ipad/i.test(s),f=i.isiOS()&&!c,l=(d=i.isiOS()||i.isAndroid())||u("(pointer:coarse)"),m=c||!f&&d&&u("(min-device-width:768px)"),p=f||d&&!m,g=a.isSafari()&&i.isiOS()&&!1===/safari/i.test(s),{isiPad:r(c),isiPhone:r(f),isTablet:r(m),isPhone:r(p),isTouch:r(l),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:r(g),isDesktop:r(!p&&!m&&!g)})};var e,t,n,o,i,a,s,u,c,f,d,l,m,p,g,v,h,y,S}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Y||(Y=!0,z=q.apply(null,e)),z}),me={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Q(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return Q(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return Q(n)},fromDom:Q,fromPoint:function(e,t,n){return E.from(e.dom.elementFromPoint(t,n)).map(Q)}},pe=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ge=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),ve=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),he=tinymce.util.Tools.resolve("tinymce.util.VK"),ye=Object.keys;function Se(e){return e.dom.nodeName.toLowerCase()}function Ce(e){return function(t){return Bt(t)&&Se(t)===e}}function be(e,t){var n=e.dom;j(t,(function(e,t){!function(e,t,n){if(!(c(n)||l(n)||p(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(n,t,e)}))}function Ne(e){return N(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}function Oe(e){return E.from(e.dom.parentNode).map(me.fromDom)}function Le(e){return S(e.dom.childNodes,me.fromDom)}function Te(e,t){var n=e.dom.childNodes;return E.from(n[t]).map(me.fromDom)}function De(e){return Te(e,0)}function xe(e){return Te(e,e.dom.childNodes.length-1)}function Ae(e,t){Oe(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))}function we(e,t){e.dom.appendChild(t.dom)}function ke(e,t){C(t,(function(t){we(e,t)}))}function Ee(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)}function Ie(e){return me.fromDom(e.dom.cloneNode(!0))}function Pe(e,t){var n,r,o=(n=e,be(r=me.fromTag(t),Ne(n)),r);return Ae(e,o),ke(o,Le(e)),Ee(e),o}function Be(e){return function(t){return t&&t.nodeName.toLowerCase()===e}}function Re(e){return function(t){return t&&e.test(t.nodeName)}}function Me(e){return e&&3===e.nodeType}function Ue(e,t){return t&&e.schema.getTextBlockElements()[t.nodeName]}function _e(e,t){return e&&e.nodeName in t}function $e(e,t,n){var r=e.isEmpty(t);return!(n&&0<e.select("span[data-mce-type=bookmark]",t).length)&&r}function Fe(e,t){return e.isChildOf(t,e.getRoot())}function He(e,t){var n,r,o,i,a=e.dom,s=e.schema.getBlockElements(),u=a.createFragment(),c=!1===(n=e.getParam("forced_root_block","p"))?"":!0===n?"p":n;if(c&&((o=a.create(c)).tagName===c.toUpperCase()&&a.setAttribs(o,e.getParam("forced_root_block_attrs",{})),_e(t.firstChild,s)||u.appendChild(o)),t)for(;r=t.firstChild;){var f=r.nodeName;i||"SPAN"===f&&"bookmark"===r.getAttribute("data-mce-type")||(i=!0),_e(r,s)?(u.appendChild(r),o=null):c?(o||(o=a.create(c),u.appendChild(o)),o.appendChild(r)):u.appendChild(r)}return c?i||o.appendChild(a.create("br",{"data-mce-bogus":"1"})):u.appendChild(a.create("br")),u}function je(e){Qt(e)&&Pe(e,"dd")}function Ke(e,t,n){C(n,"Indent"===t?je:function(t){return n=e,Wt(r=t)?Pe(r,"dt"):Qt(r)&&Oe(r).each((function(e){return function(e,t,n){var r=Vt.select('span[data-mce-type="bookmark"]',t),o=He(e,n),i=Vt.createRng();i.setStartAfter(n),i.setEndAfter(t);for(var a,s=i.extractContents(),u=s.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){Vt.remove(u);break}e.dom.isEmpty(s)||Vt.insertAfter(s,t),Vt.insertAfter(o,t),$e(e.dom,n.parentNode)&&(a=n.parentNode,Mt.each(r,(function(e){a.parentNode.insertBefore(e,n.parentNode)})),Vt.remove(a)),Vt.remove(n),$e(e.dom,t)&&Vt.remove(t)}(n,e.dom,r.dom)})),0;var n,r})}function Ve(e,t){if(Me(e))return{container:e,offset:t};var n=ge.getNode(e,t);return Me(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Me(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Me(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}}function We(e){var t=e.cloneRange(),n=Ve(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Ve(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t}function Qe(e,t){var n=t||e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",qt(e,n))}function Xe(e){var t,n,r=e.selection.getSelectedBlocks();return b((t=e,n=Mt.map(r,(function(e){return t.dom.getParent(e,"li,dd,dt",qt(t,e))||e})),Xt.unique(n)),Ft)}function qe(e,t){return w(e.dom.getParents(t,"ol,ul",qt(e,t)))}function ze(e,t,n){return void 0===n&&(n=i),e.exists((function(e){return n(e,t)}))}function Ye(e,t,n){return e.isSome()&&t.isSome()?E.some(n(e.getOrDie(),t.getOrDie())):E.none()}function Ze(e,t,n){return e.fire("ListMutation",{action:t,element:n})}function Ge(e,t){we(e.item,t.list)}function Je(e,t){for(var n=0;n<e.length-1;n++)(function(e,t,n){if(!c(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);void 0!==e.style&&m(e.style.getPropertyValue)&&e.style.setProperty(t,n)})(e[n].item.dom,"list-style-type","none");w(e).each((function(e){be(e.list,t.listAttributes),be(e.item,t.itemAttributes),ke(e.item,t.content)}))}function et(e,t,n){var r=t.slice(0,n.depth);return w(r).each((function(t){var r,o,i,a,s,u,c=(r=n.itemAttributes,o=n.content,be(i=me.fromTag("li",e),r),ke(i,o),i);we((a=t).list,c),a.item=c,u=n,Se((s=t).list)!==u.listType&&(s.list=Pe(s.list,u.listType)),be(s.list,u.listAttributes)})),r}function tt(e,t,n){var r,o=function(e,t,n){for(var r,o,i,a=[],s=0;s<n;s++)a.push((o=t.listType,we((i={list:me.fromTag(o,r=e),item:me.fromTag("li",r)}).list,i.item),i));return a}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)Ge(e[t-1],e[t])}(o),Je(o,n),r=o,Ye(w(t),A(r),Ge),t.concat(o)}function nt(e){return pe(e,"OL,UL")}function rt(e){return De(e).exists(nt)}function ot(e){return 0<e.depth}function it(e){return e.isSelected}function at(e){return C(e,(function(t,r){function o(e){return e.depth===u&&!e.dirty}function i(e){return e.depth<u}var a,s,u;u=(a=e)[s=r].depth,O(D(a.slice(0,s)),o,i).orThunk((function(){return O(a.slice(s+1),o,i)})).fold((function(){var e,r,o,i,a,s;t.dirty&&(t.listAttributes=(e=t.listAttributes,o=function(e,t){return"start"!==t},i=r={},a=function(e,t){i[t]=e},s=n,j(e,(function(e,t){(o(e,t)?a:s)(e,t)})),r))}),(function(e){var n=e;t.listType=n.listType,t.listAttributes=B({},n.listAttributes)}))})),e}function st(e,t,n,r){return De(r).filter(nt).fold((function(){t.each((function(e){F(e.start,r)&&n.set(!0)}));var o,i,a,s=(o=r,i=e,a=n.get(),Oe(o).filter(Bt).map((function(e){return{depth:i,dirty:!1,isSelected:a,content:(n=Le(t=o),S(xe(t).exists(nt)?n.slice(0,-1):n,Ie)),itemAttributes:Ne(o),listAttributes:Ne(e),listType:Se(e)};var t,n})));t.each((function(e){F(e.end,r)&&n.set(!1)}));var u=xe(r).filter(nt).map((function(r){return Yt(e,t,n,r)})).getOr([]);return s.toArray().concat(u)}),(function(r){return Yt(e,t,n,r)}))}function ut(e,t){return S(at(t),(function(t){var n,r,o=(n=t.content,r=document.createDocumentFragment(),C(n,(function(e){r.appendChild(e.dom)})),me.fromDom(r));return me.fromDom(He(e,o.dom))}))}function ct(e,t){var n=at(t),r=e.contentDocument;return A(N(n,(function(e,t){return(t.depth>e.length?tt:et)(r,e,t)}),[])).map((function(e){return e.list})).toArray()}function ft(e,t){C(b(e,it),(function(e){return function(e){switch(t){case"Indent":e.depth++;break;case"Outdent":e.depth--;break;case"Flatten":e.depth=0}e.dirty=!0}(e),0}))}function dt(e,t){var n,r,o,i,s,u,c,f,d,l,m,p,g,v=S((i=qe(o=r=e,o.selection.getStart()),s=b(o.selection.getSelectedBlocks(),_t),u=i.toArray().concat(s),zt(r,u)),me.fromDom),h=S(b(Xe(e),Ht),me.fromDom),y=!1;return(v.length||h.length)&&(n=e.selection.getBookmark(),f=t,C((d=v,g=S(Xe(c=e),me.fromDom),l=Ye(L(g,a(rt)),L(D(g),a(rt)),(function(e,t){return{start:e,end:t}})),m=!1,p={get:function(){return m},set:function(e){m=e}},S(d,(function(e){return{sourceList:e,entries:Yt(0,l,p,e)}}))),(function(e){ft(e.entries,f);var t,n,r=(t=c,T(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var s=e[i],u=t(s);u!==n&&(r.push(o),o=[]),n=u,o.push(s)}return 0!==o.length&&r.push(o),r}(e.entries,ot),(function(e){return(A(e).exists(ot)?ct:ut)(t,e)})));C(r,(function(e){Ze(c,"Indent"===f?"IndentList":"OutdentList",e.dom)})),n=e.sourceList,C(r,(function(e){Ae(n,e)})),Ee(e.sourceList)})),Ke(e,t,h),e.selection.moveToBookmark(n),e.selection.setRng(We(e.selection.getRng())),e.nodeChanged(),y=!0),y}function lt(e){return dt(e,"Indent")}function mt(e){return dt(e,"Outdent")}function pt(e){return dt(e,"Flatten")}function gt(e){function t(t){var r,o=e[t?"startContainer":"endContainer"],i=e[t?"startOffset":"endOffset"];1===o.nodeType&&(r=Gt.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),t?o.insertBefore(r,o.childNodes[i]):Gt.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),n[t?"startContainer":"endContainer"]=o,n[t?"startOffset":"endOffset"]=i}var n={};return t(!0),e.collapsed||t(),n}function vt(e){function t(t){var n,r=n=e[t?"startContainer":"endContainer"],o=e[t?"startOffset":"endOffset"];r&&(1===r.nodeType&&(o=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(r),r=r.parentNode,Gt.remove(n),!r.hasChildNodes()&&Gt.isBlock(r)&&r.appendChild(Gt.create("br"))),e[t?"startContainer":"endContainer"]=r,e[t?"startOffset":"endOffset"]=o)}t(!0),t();var n=Gt.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),We(n)}function ht(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}}function yt(e){return/\btox\-/.test(e.className)}function St(e,t,n){function r(e){var r=O(e.parents,Ut,jt).filter((function(e){return e.nodeName===t&&!yt(e)})).isSome();n(r)}return r({parents:e.dom.getParents(e.selection.getNode())}),e.on("NodeChange",r),function(){return e.off("NodeChange",r)}}function Ct(e,t){Mt.each(t,(function(t,n){e.setAttribute(n,t)}))}function bt(e,t,n){var r,o,i,a=n["list-style-type"]||null;e.setStyle(t,"list-style-type",a),r=e,Ct(o=t,(i=n)["list-attributes"]),Mt.each(r.select("li",o),(function(e){Ct(e,i["list-item-attributes"])}))}function Nt(e,t,n,r){var o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&Kt(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(Ue(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o}function Ot(e,t,n){var r,o,i=e.selection.getRng(),a="LI",s=qt(e,e.selection.getStart(!0)),u=e.dom;"false"!==u.getContentEditable(e.selection.getNode())&&("DL"===(t=t.toUpperCase())&&(a="DT"),r=gt(i),o=function(e,t,n){for(var r,o=[],i=e.dom,a=Nt(e,t,!0,n),s=Nt(e,t,!1,n),u=[],c=a;c&&(u.push(c),c!==s);c=c.nextSibling);return Mt.each(u,(function(t){if(Ue(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||Kt(t))return Kt(t)&&i.remove(t),void(r=null);var a=t.nextSibling;Zt.isBookmarkNode(t)&&(Ut(a)||Ue(e,a)||!a&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,i,s),Mt.each(o,(function(r){var o,i,s,c,f,d=r.previousSibling,l=r.parentNode;Ft(l)||(d&&Ut(d)&&d.nodeName===t&&(c=n,u.getStyle(d,"list-style-type")===(f=null===(f=c?c["list-style-type"]:"")?"":f))?(o=d,r=u.rename(r,a),d.appendChild(r)):(o=u.create(t),r.parentNode.insertBefore(o,r),o.appendChild(r),r=u.rename(r,a)),i=u,s=r,Mt.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],(function(e){var t;return i.setStyle(s,((t={})[e]="",t))})),bt(u,o,n),Jt(e.dom,o))})),e.selection.setRng(vt(r)))}function Lt(e,t,n){return a=n,(i=t)&&a&&Ut(i)&&i.nodeName===a.nodeName&&(o=n,(r=e).getStyle(t,"list-style-type",!0)===r.getStyle(o,"list-style-type",!0))&&t.className===n.className;var r,o,i,a}function Tt(e,t,n){var r,o,i,a,s,u,c,d,l,m,p,g,v,h,y,S,C,N=Qe(e),O=(d=Qe(c=e),l=c.selection.getSelectedBlocks(),d&&1===l.length&&l[0]===d?b(d.querySelectorAll("ol,ul,dl"),Ut):b(l,(function(e){return Ut(e)&&d!==e}))),L=f(n)?n:{};0<O.length?(m=e,g=O,v=t,h=L,(C=Ut(p=N))&&p.nodeName===v&&!en(h)?pt(m):(Ot(m,v,h),y=gt(m.selection.getRng()),S=C?function(e,t){for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||((n=n||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([p],g):g,Mt.each(S,(function(e){var t,n,r=m,o=v,i=h;(t=e).nodeName!==o?(n=r.dom.rename(t,o),bt(r.dom,n,i),Ze(r,ht(o),n)):(bt(r.dom,t,i),Ze(r,ht(o),t))})),m.selection.setRng(vt(y)))):(i=t,a=L,(o=N)!==(r=e).getBody()&&(o?o.nodeName!==i||en(a)||yt(o)?(s=gt(r.selection.getRng()),bt(r.dom,o,a),u=r.dom.rename(o,i),Jt(r.dom,u),r.selection.setRng(vt(s)),Ot(r,i,a),Ze(r,ht(i),u)):pt(r):(Ot(r,i,a),Ze(r,ht(i),o))))}function Dt(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(Me(o)&&(n?i<o.data.length:0<i))return o;var a=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ge.getNode(o,i));var s,u,c=new ve(o,r);for(n&&(s=e.dom,Kt(u=o)&&s.isBlock(u.nextSibling)&&!Kt(u.previousSibling)&&c.next());o=c[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(a[o.nodeName])return o;if(Me(o)&&0<o.data.length)return o}}function xt(e,t){var n=t.childNodes;return 1===n.length&&!Ut(n[0])&&e.isBlock(n[0])}function At(e,t,n){var r,o,i,a=t.parentNode;Fe(e,t)&&Fe(e,n)&&(Ut(n.lastChild)&&(r=n.lastChild),a===n.lastChild&&Kt(a.previousSibling)&&e.remove(a.previousSibling),(o=n.lastChild)&&Kt(o)&&t.hasChildNodes()&&e.remove(o),$e(e,n,!0)&&e.$(n).empty(),function(e,t,n){var r,o,i,a=xt(e,n)?n.firstChild:n;if(xt(o=e,i=t)&&o.remove(i.firstChild,!0),!$e(e,t,!0))for(;r=t.firstChild;)a.appendChild(r)}(e,t,n),r&&n.appendChild(r),i=H(me.fromDom(n),me.fromDom(t))?e.getParents(t,Ut,n):[],e.remove(t),C(i,(function(t){$e(e,t)&&t!==e.getRoot()&&e.remove(t)})))}function wt(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=qt(e,o),a=n.getParent(r.getStart(),"LI",i);if(a){var s=a.parentNode;if(s===e.getBody()&&$e(n,s))return 1;var u=We(r.getRng()),c=n.getParent(Dt(e,u,t,i),"LI",i);if(c&&c!==a)return e.undoManager.transact((function(){var n,r,o,i,s,f,d,l,m;t?(r=u,o=c,i=a,(m=(n=e).dom).isEmpty(i)?(d=o,(f=n).dom.$(l=i).empty(),At(f.dom,d,l),f.selection.setCursorLocation(l,0)):(s=gt(r),At(m,o,i),n.selection.setRng(vt(s)))):a.parentNode.firstChild===a?mt(e):function(e,t,n){var r=gt(u);At(e.dom,t,n);var o=vt(r);e.selection.setRng(o)}(e,a,c)})),1;if(!c&&!t&&0===u.startOffset&&0===u.endOffset)return e.undoManager.transact((function(){pt(e)})),1}}function kt(e,t){return e.selection.isCollapsed()?wt(i=e,a=t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=qt(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var a=We(e.selection.getRng()),s=n.getParent(Dt(e,a,t,o),"LI",o);if(s)return e.undoManager.transact((function(){var r,a=i,u=(r=n).getParent(a.parentNode,r.isBlock,o);r.remove(a),u&&r.isEmpty(u)&&r.remove(u),Jt(n,s.parentNode),e.selection.select(s,!0),e.selection.collapse(t)})),1}}(i,a):(r=(n=e).selection.getStart(),o=qt(n,r),(n.dom.getParent(r,"LI,DT,DD",o)||0<Xe(n).length)&&(n.undoManager.transact((function(){var e,t,r;n.execCommand("Delete"),e=n.dom,t=n.getBody(),r=Mt.grep(e.select("ol,ul",t)),Mt.each(r,(function(t){var n,r,o,i=e;"LI"===(o=(n=t).parentNode).nodeName&&o.firstChild===n&&((r=o.previousSibling)&&"LI"===r.nodeName?(r.appendChild(n),$e(i,o)&&tn.remove(o)):tn.setStyle(o,"listStyleType","none")),Ut(o)&&(r=o.previousSibling)&&"LI"===r.nodeName&&r.appendChild(n)}))})),1));var n,r,o,i,a}function Et(e){return N(S(D(J(e).split("")),(function(e,t){var n=e.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*n})),(function(e,t){return e+t}),0)}function It(e,t){return function(){var n=Qe(e);return n&&n.nodeName===t}}function Pt(e){e.addCommand("mceListProps",(function(){var t,n,r,o;o=Qe(t=e),$t(o)&&t.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:(n={start:t.dom.getAttrib(o,"start","1"),listStyleType:E.some(t.dom.getStyle(o,"list-style-type"))},r=parseInt(n.start,10),ze(n.listStyleType,"upper-alpha")?nn(r):ze(n.listStyleType,"lower-alpha")?nn(r).toLowerCase():n.start)},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(e){(function(e){switch(/^[0-9]+$/.test(t=e)?2:/^[A-Z]+$/.test(t)?0:/^[a-z]+$/.test(t)?1:0<t.length?4:3){case 2:return E.some({listStyleType:E.none(),start:e});case 0:return E.some({listStyleType:E.some("upper-alpha"),start:Et(e).toString()});case 1:return E.some({listStyleType:E.some("lower-alpha"),start:Et(e).toString()});case 3:return E.some({listStyleType:E.none(),start:""});case 4:return E.none()}var t})(e.getData().start).each((function(e){t.execCommand("mceListUpdate",!1,{attrs:{start:"1"===e.start?"":e.start},styles:{"list-style-type":e.listStyleType.getOr("")}})})),e.close()}})}))}function Bt(e){return 1===e.dom.nodeType}"undefined"!=typeof window||Function("return this;")();var Rt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Mt=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ut=Re(/^(OL|UL|DL)$/),_t=Re(/^(OL|UL)$/),$t=Be("ol"),Ft=Re(/^(LI|DT|DD)$/),Ht=Re(/^(DT|DD)$/),jt=Re(/^(TH|TD)$/),Kt=Be("br"),Vt=Rt.DOM,Wt=Ce("dd"),Qt=Ce("dt"),Xt=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),qt=function(e,t){var n=e.dom.getParents(t,"TD,TH");return 0<n.length?n[0]:e.getBody()},zt=function(e,t){var n=S(t,(function(t){return qe(e,t).getOr(t)}));return Xt.unique(n)},Yt=function(e,t,n,r){return T(Le(r),(function(r){return(nt(r)?Yt:st)(e+1,t,n,r)}))},Zt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),Gt=Rt.DOM,Jt=function(e,t){var n,r=t.nextSibling;if(Lt(e,t,r)){for(;n=r.firstChild;)t.appendChild(n);e.remove(r)}if(Lt(e,t,r=t.previousSibling)){for(;n=r.lastChild;)t.insertBefore(n,t.firstChild);e.remove(r)}},en=function(e){return"list-style-type"in e},tn=Rt.DOM,nn=function(e){if(--e<0)return"";var t=e%26,n=Math.floor(e/26);return nn(n)+String.fromCharCode("A".charCodeAt(0)+t)};u.add("lists",(function(e){var t,n,r,o,i,a,s,u;return!1===e.hasPlugin("rtc",!0)?((a=e).getParam("lists_indent_on_tab",!0)&&(s=a).on("keydown",(function(e){e.keyCode!==he.TAB||he.metaKeyPressed(e)||s.undoManager.transact((function(){(e.shiftKey?mt:lt)(s)&&e.preventDefault()}))})),(u=a).on("keydown",(function(e){e.keyCode===he.BACKSPACE?kt(u,!1)&&e.preventDefault():e.keyCode===he.DELETE&&kt(u,!0)&&e.preventDefault()})),(i=e).on("BeforeExecCommand",(function(e){var t=e.command.toLowerCase();"indent"===t?lt(i):"outdent"===t&&mt(i)})),i.addCommand("InsertUnorderedList",(function(e,t){Tt(i,"UL",t)})),i.addCommand("InsertOrderedList",(function(e,t){Tt(i,"OL",t)})),i.addCommand("InsertDefinitionList",(function(e,t){Tt(i,"DL",t)})),i.addCommand("RemoveList",(function(){pt(i)})),Pt(i),i.addCommand("mceListUpdate",(function(e,t){var n,r,o;f(t)&&(r=t,o=Qe(n=i),n.undoManager.transact((function(){f(r.styles)&&n.dom.setStyles(o,r.styles),f(r.attrs)&&j(r.attrs,(function(e,t){return n.dom.setAttrib(o,t,e)}))})))})),i.addQueryStateHandler("InsertUnorderedList",It(i,"UL")),i.addQueryStateHandler("InsertOrderedList",It(i,"OL")),i.addQueryStateHandler("InsertDefinitionList",It(i,"DL"))):Pt(e),(o=e).hasPlugin("advlist")||(o.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:c("InsertOrderedList"),onSetup:function(e){return St(o,"OL",e.setActive)}}),o.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:c("InsertUnorderedList"),onSetup:function(e){return St(o,"UL",e.setActive)}})),n={text:"List properties...",icon:"ordered-list",onAction:function(){return t.execCommand("mceListProps")},onSetup:function(e){return St(t,"OL",(function(t){return e.setDisabled(!t)}))}},(t=e).ui.registry.addMenuItem("listprops",n),t.ui.registry.addContextMenu("lists",{update:function(e){var n=Qe(t,e);return $t(n)?["listprops"]:[]}}),r=e,{backspaceDelete:function(e){kt(r,e)}};function c(e){return function(){return o.execCommand(e)}}}))}();