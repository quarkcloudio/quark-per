!function(){"use strict";function e(e){return e.getParam("pagebreak_split_block",!1)}function a(e){var a='<img src="'+t.transparentSrc+'" class="'+r+'" data-mce-resize="false" data-mce-placeholder />';return e?"<p>"+a+"</p>":a}var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),r="mce-pagebreak";n.add("pagebreak",(function(n){var t,o,c,i,g,u;function l(){return o.execCommand("mcePageBreak")}function m(){return e(c)}(t=n).addCommand("mcePageBreak",(function(){t.insertContent(a(e(t)))})),(o=n).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:l}),o.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:l}),i=(c=n).getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),g=new RegExp(i.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,(function(e){return"\\"+e})),"gi"),c.on("BeforeSetContent",(function(e){e.content=e.content.replace(g,a(m()))})),c.on("PreInit",(function(){c.serializer.addNodeFilter("img",(function(e){for(var a,n,t,o=e.length;o--;)(t=(n=e[o]).attr("class"))&&-1!==t.indexOf(r)&&(a=n.parent,c.schema.getBlockElements()[a.name]&&m()?(a.type=3,a.value=i,a.raw=!0,n.remove()):(n.type=3,n.value=i,n.raw=!0))}))})),(u=n).on("ResolveName",(function(e){"IMG"===e.target.nodeName&&u.dom.hasClass(e.target,r)&&(e.name="pagebreak")}))}))}();