!function(){"use strict";function e(e){return/^[(\[{ \u00a0]$/.test(e)}function t(e){return 3===e.nodeType}function n(e){return 1===e.nodeType}function i(e,n){var i;return n<0&&(n=0),!t(e)||(i=e.data.length)<n&&(n=i),n}function o(e,t,o){!n(t)||t.hasChildNodes()?e.setStart(t,i(t,o)):e.setStartBefore(t)}function r(e,t,o){!n(t)||t.hasChildNodes()?e.setEnd(t,i(t,o)):e.setEndAfter(t)}function a(n,i){var a,f,s,l,u,c=n.getParam("autolink_pattern",d),g=n.getParam("default_link_target",!1);if(null===n.dom.getParent(n.selection.getNode(),"a[href]")){var h=n.selection.getRng().cloneRange();if(h.startOffset<5){if(!(l=h.endContainer.previousSibling)){if(!h.endContainer.firstChild||!h.endContainer.firstChild.nextSibling)return;l=h.endContainer.firstChild.nextSibling}if(o(h,l,u=l.length),r(h,l,u),h.endOffset<5)return;a=h.endOffset,f=l}else{if(!t(f=h.endContainer)&&f.firstChild){for(;!t(f)&&f.firstChild;)f=f.firstChild;t(f)&&(o(h,f,0),r(h,f,f.nodeValue.length))}a=1===h.endOffset?2:h.endOffset-1-i}for(var C=a;o(h,f,2<=a?a-2:0),r(h,f,1<=a?a-1:0),--a,!e(h.toString())&&0<=a-2;);e(h.toString())?(o(h,f,a),r(h,f,C),a+=1):(0===h.startOffset?o(h,f,0):o(h,f,a),r(h,f,C)),m=h.toString(),/[?!,.;:]/.test(m.charAt(m.length-1))&&r(h,f,C-1);var m,k,w,y,v=(m=h.toString().trim()).match(c),A=n.getParam("link_default_protocol","http","string");v&&((w=k=v[0]).length>=(y="www.").length&&w.substr(0,0+y.length)===y?k=A+"://"+k:-1===k.indexOf("@")||/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(k)||(k="mailto:"+k),s=n.selection.getBookmark(),n.selection.setRng(h),n.execCommand("createlink",!1,k),!1!==g&&n.dom.setAttrib(n.selection.getNode(),"target",g),n.selection.moveToBookmark(s),n.nodeChanged())}}var f=tinymce.util.Tools.resolve("tinymce.PluginManager"),s=tinymce.util.Tools.resolve("tinymce.Env"),d=new RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-+~=.,%()\/\w]*[-+~=%()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i");f.add("autolink",(function(e){var t,n;(t=e).on("keydown",(function(e){if(13===e.keyCode)return a(t,-1)})),s.browser.isIE()?t.on("focus",(function(){if(!n){n=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}})):(t.on("keypress",(function(e){if(41===e.keyCode||93===e.keyCode||125===e.keyCode)return a(t,-1)})),t.on("keyup",(function(e){if(32===e.keyCode)return a(t,0)})))}))}();