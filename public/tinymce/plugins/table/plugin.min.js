!function(){"use strict";function e(e){return function(n){return r=typeof(t=n),(null===t?"null":"object"==r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r)===e;var t,r}}function n(e){return function(n){return typeof n===e}}function t(e){return function(n){return e===n}}function r(e){return!(null==e)}function o(){}function u(e){return function(){return e}}function i(e){return e}function c(e,n){return e===n}var l=e("string"),a=e("object"),f=e("array"),s=t(null),m=n("boolean"),d=t(void 0),g=n("function"),p=n("number");function b(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.concat(t);return e.apply(null,o)}}function h(e){return function(n){return!e(n)}}function v(){return C}var w=u(!1),y=u(!0),C={fold:function(e,n){return e()},isSome:w,isNone:y,getOr:i,getOrThunk:S,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:i,orThunk:S,map:v,each:o,bind:v,exists:w,forall:y,filter:function(){return C},toArray:function(){return[]},toString:u("none()")};function S(e){return e()}function T(e,n){return-1<G.call(e,n)}function x(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return!0;return!1}function R(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t}function D(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var u=e[o];r[o]=n(u,o)}return r}function O(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)}function A(e,n){for(var t=[],r=[],o=0,u=e.length;o<u;o++){var i=e[o];(n(i,o)?t:r).push(i)}return{pass:t,fail:r}}function k(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var u=e[r];n(u,r)&&t.push(u)}return t}function I(e,n,t){return function(e){for(var r,o=e.length-1;0<=o;o--)r=e[o],t=n(t,r,o)}(e),t}function B(e,n,t){return O(e,(function(e,r){t=n(t,e,r)})),t}function M(e,n){return function(e,n,t){for(var r=0,o=e.length;r<o;r++){var u=e[r];if(n(u,r))return q.some(u);if(t(u,r))break}return q.none()}(e,n,w)}function E(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return q.some(t);return q.none()}function P(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!f(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);$.apply(n,e[t])}return n}function N(e,n){return P(D(e,n))}function z(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t))return!1;return!0}function L(e,n){for(var t={},r=0,o=e.length;r<o;r++){var u=e[r];t[String(u)]=n(u,r)}return t}function _(e){return[e]}function W(e,n){return 0<=n&&n<e.length?q.some(e[n]):q.none()}function j(e){return W(e,0)}function F(e){return W(e,e.length-1)}function H(e,n){for(var t=0;t<e.length;t++){var r=n(e[t],t);if(r.isSome())return r}return q.none()}var V=function(e){function n(){return o}function t(n){return n(e)}var r=u(e),o={fold:function(n,t){return t(e)},isSome:y,isNone:w,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return V(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?o:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},q={some:V,none:v,from:function(e){return null==e?C:V(e)}},U=Array.prototype.slice,G=Array.prototype.indexOf,$=Array.prototype.push,K=function(){return(K=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function X(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||((r=r||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}function Y(e){var n,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,n=e.apply(null,r)),n}}function J(e,n){var t=String(n).toLowerCase();return M(e,(function(e){return e.search(t)}))}function Q(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function Z(e,n){return-1!==e.indexOf(n)}function ee(e,n){return Q(e,n,e.length-n.length)}function ne(e){return 0<e.length}function te(e){return function(n){return Z(n,e)}}function re(e){return window.matchMedia(e).matches}function oe(e,n){var t=e.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function ue(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function ie(e,n){var t=void 0===n?document:n.dom;return ue(t)?q.none():q.from(t.querySelector(e)).map(Ve.fromDom)}function ce(e,n){return e.dom===n.dom}function le(e,n){return He().browser.isIE()?(t=e.dom,r=n.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(r)&o)):(u=e.dom)!==(i=n.dom)&&u.contains(i);var t,r,o,u,i}function ae(e,n){for(var t=Ue(e),r=0,o=t.length;r<o;r++){var u=t[r];n(e[u],u)}}function fe(e,n){return $e(e,(function(e,t){return{k:t,v:n(e,t)}}))}function se(e,n){var t={},r=n,u=t,i=function(e,n){u[n]=e},c=o;return ae(e,(function(e,n){(r(e,n)?i:c)(e,n)})),t}function me(e,n){var t=[];return ae(e,(function(e,r){t.push(n(e,r))})),t}function de(e){return me(e,i)}function ge(e){return Ue(e).length}function pe(e,n){return Ke(e,n)?q.from(e[n]):q.none()}function be(e,n){return Ke(e,n)&&void 0!==e[n]&&null!==e[n]}function he(e,n,t){return{element:e,rowspan:n,colspan:t}}function ve(e,n,t){return{element:e,cells:n,section:t}}function we(e,n,t){return{element:e,isNew:n,isLocked:t}}function ye(e,n,t,r){return{element:e,cells:n,section:t,isNew:r}}function Ce(){return De(0,0)}function Se(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Me),isSafari:n("Safari")}}function Te(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isWindows:n(Ne),isiOS:n("iOS"),isAndroid:n(ze),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Le),isFreeBSD:n(_e),isChromeOS:n(We)}}function xe(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}var Re,De=function(e,n){return{major:e,minor:n}},Oe={nu:De,detect:function(e,n){var t,r,o=String(n).toLowerCase();return 0===e.length?Ce():(r=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,t=o))?De(u(1),u(2)):{major:0,minor:0};function u(e){return Number(t.replace(r,"$"+e))}},unknown:Ce},Ae=function(e,n){return Q(e,n,0)},ke=(Re=/^\s+|\s+$/g,function(e){return e.replace(Re,"")}),Ie=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Be={browsers:u([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Z(e,"edge/")&&Z(e,"chrome")&&Z(e,"safari")&&Z(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ie],search:function(e){return Z(e,"chrome")&&!Z(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Z(e,"msie")||Z(e,"trident")}},{name:"Opera",versionRegexes:[Ie,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:te("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:te("firefox")},{name:"Safari",versionRegexes:[Ie,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Z(e,"safari")||Z(e,"mobile/"))&&Z(e,"applewebkit")}}]),oses:u([{name:"Windows",search:te("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Z(e,"iphone")||Z(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:te("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:te("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:te("linux"),versionRegexes:[]},{name:"Solaris",search:te("sunos"),versionRegexes:[]},{name:"FreeBSD",search:te("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:te("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Me="Firefox",Ee=function(){return Se({current:void 0,version:Oe.unknown()})},Pe=Se,Ne=(u("Edge"),u("Chrome"),u("IE"),u("Opera"),u(Me),u("Safari"),"Windows"),ze="Android",Le="Solaris",_e="FreeBSD",We="ChromeOS",je=function(){return Te({current:void 0,version:Oe.unknown()})},Fe=Te,He=(u(Ne),u("iOS"),u(ze),u("Linux"),u("OSX"),u(Le),u(_e),u(We),Y((function(){return e=navigator.userAgent,n=q.from(navigator.userAgentData),t=re,b=Be.browsers(),h=Be.oses(),v=n.bind((function(e){return n=b,H(e.brands,(function(e){var t=e.brand.toLowerCase();return M(n,(function(e){var n;return t===(null===(n=e.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(n){return{current:n.name,version:Oe.nu(parseInt(e.version,10),0)}}))}));var n})).orThunk((function(){return J(b,n=e).map((function(e){var t=Oe.detect(e.versionRegexes,n);return{current:e.name,version:t}}));var n})).fold(Ee,Pe),w=J(h,r=e).map((function(e){var n=Oe.detect(e.versionRegexes,r);return{current:e.name,version:n}})).fold(je,Fe),{browser:v,os:w,deviceType:(i=v,c=e,l=t,a=(o=w).isiOS()&&!0===/ipad/i.test(c),f=o.isiOS()&&!a,m=(s=o.isiOS()||o.isAndroid())||l("(pointer:coarse)"),d=a||!f&&s&&l("(min-device-width:768px)"),g=f||s&&!d,p=i.isSafari()&&o.isiOS()&&!1===/safari/i.test(c),{isiPad:u(a),isiPhone:u(f),isTablet:u(d),isPhone:u(g),isTouch:u(m),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:u(p),isDesktop:u(!g&&!d&&!p)})};var e,n,t,r,o,i,c,l,a,f,s,m,d,g,p,b,h,v,w}))),Ve={fromHtml:function(e,n){var t=(n||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return xe(t.childNodes[0])},fromTag:function(e,n){var t=(n||document).createElement(e);return xe(t)},fromText:function(e,n){var t=(n||document).createTextNode(e);return xe(t)},fromDom:xe,fromPoint:function(e,n,t){return q.from(e.dom.elementFromPoint(n,t)).map(xe)}},qe=oe,Ue=Object.keys,Ge=Object.hasOwnProperty,$e=function(e,n){var t={};return ae(e,(function(e,r){var o=n(e,r);t[o.k]=o.v})),t},Ke=function(e,n){return Ge.call(e,n)},Xe=["tfoot","thead","tbody","colgroup"];function Ye(e){return e.dom.nodeName.toLowerCase()}function Je(e){return e.dom.nodeType}function Qe(e){return function(n){return Je(n)===e}}function Ze(e){return 8===Je(e)||"#comment"===Ye(e)}function en(e){return function(n){return gn(n)&&Ye(n)===e}}function nn(e){return Ve.fromDom(e.dom.ownerDocument)}function tn(e){return bn(e)?e:nn(e)}function rn(e){return q.from(e.dom.parentNode).map(Ve.fromDom)}function on(e,n){for(var t=g(n)?n:w,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Ve.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function un(e){return q.from(e.dom.previousSibling).map(Ve.fromDom)}function cn(e){return q.from(e.dom.nextSibling).map(Ve.fromDom)}function ln(e){return D(e.dom.childNodes,Ve.fromDom)}function an(e,n){var t=e.dom.childNodes;return q.from(t[n]).map(Ve.fromDom)}function fn(e){return Ve.fromDom(e.dom.host)}function sn(e,n,t){return r=function(e){return oe(e,n)},k(on(e,t),r);var r}function mn(e,n){return t=function(e){return oe(e,n)},k(ln(e),t);var t}function dn(e,n){return ue(t=void 0===e?document:e.dom)?[]:D(t.querySelectorAll(n),Ve.fromDom);var t}"undefined"!=typeof window||Function("return this;")();var gn=Qe(1),pn=Qe(3),bn=Qe(9),hn=Qe(11),vn=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode),wn=u(vn),yn=vn?function(e){return Ve.fromDom(e.dom.getRootNode())}:tn,Cn=function(e){return r(e.dom.shadowRoot)},Sn=function(e){var n=pn(e)?e.dom.parentNode:e.dom;if(null==n||null===n.ownerDocument)return!1;var t,o,u,i,c,l=n.ownerDocument;return u=Ve.fromDom(n),c=yn(u),(hn(i=c)&&r(i.dom.host)?q.some(c):q.none()).fold((function(){return l.body.contains(n)}),(t=Sn,o=fn,function(e){return t(o(e))}))},Tn=function(e){var n=e.dom.body;if(null==n)throw new Error("Body is not available yet");return Ve.fromDom(n)},xn=function(e,n){var t=[];return O(ln(e),(function(e){t=(t=n(e)?t.concat([e]):t).concat(xn(e,n))})),t};function Rn(e,n,t,r,o){return e(t,r)?q.some(t):g(o)&&o(t)?q.none():n(t,r,o)}function Dn(e,n,t){for(var r=e.dom,o=g(t)?t:w;r.parentNode;){r=r.parentNode;var u=Ve.fromDom(r);if(n(u))return q.some(u);if(o(u))break}return q.none()}function On(e,n,t){return Dn(e,(function(e){return oe(e,n)}),t)}function An(e,n){return t=function(e){return oe(e,n)},M(e.dom.childNodes,(function(e){return t(Ve.fromDom(e))})).map(Ve.fromDom);var t}function kn(e,n){return ie(n,e)}function In(e,n,t){return Rn(oe,On,e,n,t)}function Bn(e,n,t){if(!(l(t)||m(t)||p(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Mn(e,n,t){Bn(e.dom,n,t)}function En(e,n){var t=e.dom;ae(n,(function(e,n){Bn(t,n,e)}))}function Pn(e,n){var t=e.dom.getAttribute(n);return null===t?void 0:t}function Nn(e,n){return q.from(Pn(e,n))}function zn(e){return B(e.dom.attributes,(function(e,n){return e[n.name]=n.value,e}),{})}function Ln(e,n,t){return void 0===t&&(t=c),e.exists((function(e){return t(e,n)}))}function _n(e){for(var n=[],t=function(e){n.push(e)},r=0;r<e.length;r++)e[r].each(t);return n}function Wn(e,n,t){return e.isSome()&&n.isSome()?q.some(t(e.getOrDie(),n.getOrDie())):q.none()}function jn(e,n){return e?q.some(n):q.none()}function Fn(e){return void 0!==e.style&&g(e.style.getPropertyValue)}function Hn(e,n,t){if(!l(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);Fn(e)&&e.style.setProperty(n,t)}function Vn(e,n,t){Hn(e.dom,n,t)}function qn(e,n){var t=e.dom;ae(n,(function(e,n){Hn(t,n,e)}))}function Un(e,n){var t=e.dom,r=window.getComputedStyle(t).getPropertyValue(n);return""!==r||Sn(e)?r:jt(t,n)}function Gn(e,n){var t=e.dom,r=jt(t,n);return q.from(r).filter((function(e){return 0<e.length}))}function $n(e,n){var t,r=n;Fn(t=e.dom)&&t.style.removeProperty(r),Ln(Nn(e,"style").map(ke),"")&&Wt(e,"style")}function Kn(e,n,t){return void 0===t&&(t=0),Nn(e,n).map((function(e){return parseInt(e,10)})).getOr(t)}function Xn(e,n){return Kn(e,n,1)}function Yn(e){return en("col")(e)?1<Kn(e,"span",1):1<Xn(e,"colspan")}function Jn(e){return 1<Xn(e,"rowspan")}function Qn(e,n){return parseInt(Un(e,n),10)}function Zn(e,n){return Vt(e,n,y)}function et(e,n){return t=["td","th"],(o=void 0===(o=n)?w:n)(r=e)?q.none():T(t,Ye(r))?q.some(r):On(r,t.join(","),(function(e){return oe(e,"table")||o(e)}));var t,r,o}function nt(e){return Zn(e,"th,td")}function tt(e){return oe(e,"colgroup")?mn(e,"col"):N(qt(e),(function(e){return mn(e,"col")}))}function rt(e,n){return In(e,"table",n)}function ot(e){return Zn(e,"tr")}function ut(e,n){return D(e,(function(e){if("colgroup"!==Ye(e))return ve(e,t=D(nt(e),(function(e){return he(e,Kn(e,"rowspan",1),Kn(e,"colspan",1))})),n(e));var t=D(tt(e),(function(e){return he(e,1,Kn(e,"span",1))}));return ve(e,t,"colgroup")}))}function it(e){return rn(e).map((function(e){var n=Ye(e);return T(Xe,n)?n:"tbody"})).getOr("tbody")}function ct(e){var n=ot(e);return ut(X(X([],qt(e),!0),n,!0),it)}function lt(e,n,t){var r=e.cells,o=r.slice(0,n),u=r.slice(n),i=o.concat(t).concat(u);return Ut(e,i)}function at(e,n,t){return lt(e,n,[t])}function ft(e,n,t){e.cells[n]=t}function st(e,n){return e.cells[n]}function mt(e,n){return st(e,n).element}function dt(e){return e.cells.length}function gt(e){var n=A(e,(function(e){return"colgroup"===e.section}));return{rows:n.fail,cols:n.pass}}function pt(e,n,t){var r=D(e.cells,t);return ye(n(e.element),r,e.section,!0)}function bt(e){return Nn(e,Gt).bind((function(e){return q.from(e.match(/\d+/g))})).map((function(e){return L(e,y)}))}function ht(e){var n,t=me(B(gt(e).rows,(function(e,n){return O(n.cells,(function(n,t){n.isLocked&&(e[t]=!0)})),e}),{}),(function(e,n){return parseInt(n,10)}));return(n=U.call(t,0)).sort(void 0),n}function vt(e){var n={},t=[],r=j(e).map((function(e){return e.element})).bind(rt).bind(bt).getOr({}),o=0,u=0,i=0,c=A(e,(function(e){return"colgroup"===e.section})),l=c.pass;O(c.fail,(function(e){var c=[];O(e.cells,(function(e){for(var t=0;void 0!==n[i+","+t];)t++;for(var o=be(r,t.toString()),l={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:i,column:t,isLocked:o},a=0;a<e.colspan;a++)for(var f=0;f<e.rowspan;f++){var s=t+a;n[i+f+","+s]=l,u=Math.max(u,s+1)}c.push(l)})),o++,t.push(ve(e.element,c,e.section)),i++}));var a=F(l).map((function(e){var n,t,r=(n={},t=0,O(e.cells,(function(e){var r=e.colspan;R(r,(function(o){var u=t+o;n[u]={element:e.element,colspan:r,column:u}})),t+=r})),n);return{colgroups:[{element:e.element,columns:de(r)}],columns:r}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),f=a.columns,s=a.colgroups;return{grid:{rows:o,columns:u},access:n,all:t,columns:f,colgroups:s}}function wt(e,n){var t=n.column,r=n.column+n.colspan-1,o=n.row,u=n.row+n.rowspan-1;return t<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&u>=e.startRow}function yt(e,n){return n.column>=e.startCol&&n.column+n.colspan-1<=e.finishCol&&n.row>=e.startRow&&n.row+n.rowspan-1<=e.finishRow}function Ct(e,n,t){var r=$t.findItem(e,n,ce),o=$t.findItem(e,t,ce);return r.bind((function(e){return o.map((function(n){return t=e,r=n,{startRow:Math.min(t.row,r.row),startCol:Math.min(t.column,r.column),finishRow:Math.max(t.row+t.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(t.column+t.colspan-1,r.column+r.colspan-1)};var t,r}))}))}function St(e,n,t){return Ct(e,n,t).map((function(n){return D($t.filterItems(e,b(wt,n)),(function(e){return e.element}))}))}function Tt(e,n){return $t.findItem(e,n,(function(e,n){return le(n,e)})).map((function(e){return e.element}))}function xt(e,n,t,r,o){var u=Kt(e),i=ce(e,t)?q.some(n):Tt(u,n),c=ce(e,o)?q.some(r):Tt(u,r);return i.bind((function(e){return c.bind((function(n){return St(u,e,n)}))}))}function Rt(e,n){rn(e).each((function(t){t.dom.insertBefore(n.dom,e.dom)}))}function Dt(e,n){cn(e).fold((function(){rn(e).each((function(e){Xt(e,n)}))}),(function(e){Rt(e,n)}))}function Ot(e,n){an(e,0).fold((function(){Xt(e,n)}),(function(t){e.dom.insertBefore(n.dom,t.dom)}))}function At(e,n){Rt(e,n),Xt(n,e)}function kt(e,n){O(n,(function(t,r){Dt(0===r?e:n[r-1],t)}))}function It(e,n){O(n,(function(n){Xt(e,n)}))}function Bt(e){e.dom.textContent="",O(ln(e),(function(e){Yt(e)}))}function Mt(e){var n,t=ln(e);0<t.length&&(n=e,O(t,(function(e){Rt(n,e)}))),Yt(e)}function Et(e){return Jt.get(e)}function Pt(e){return Jt.getOption(e)}function Nt(e,n){return Jt.set(e,n)}function zt(e,n){return k(N(e.all,(function(e){return e.cells})),n)}var Lt,_t,Wt=function(e,n){e.dom.removeAttribute(n)},jt=function(e,n){return Fn(e)?e.style.getPropertyValue(n):""},Ft=u(10),Ht=u(10),Vt=function(e,n,t){return N(ln(e),(function(e){return oe(e,n)?t(e)?[e]:[]:Vt(e,n,t)}))},qt=function(e){return rt(e).fold(u([]),(function(e){return mn(e,"colgroup")}))},Ut=function(e,n){return ye(e.element,n,e.section,e.isNew)},Gt="data-snooker-locked-cols",$t={fromTable:function(e){return vt(ct(e))},generate:vt,getAt:function(e,n,t){return q.from(e.access[n+","+t])},findItem:function(e,n,t){var r=zt(e,(function(e){return t(n,e.element)}));return 0<r.length?q.some(r[0]):q.none()},filterItems:zt,justCells:function(e){return N(e.all,(function(e){return e.cells}))},justColumns:function(e){return de(e.columns)},hasColumns:function(e){return 0<Ue(e.columns).length},getColumnAt:function(e,n){return q.from(e.columns[n])}},Kt=$t.fromTable,Xt=function(e,n){e.dom.appendChild(n.dom)},Yt=function(e){var n=e.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Jt=(Lt=pn,{get:function(e){if(!Lt(e))throw new Error("Can only get text value of a text node");return _t(e).getOr("")},getOption:_t=function(e){return Lt(e)?q.from(e.dom.nodeValue):q.none()},set:function(e,n){if(!Lt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}),Qt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Zt(){return{up:u({selector:On,closest:In,predicate:Dn,all:on}),down:u({selector:dn,predicate:xn}),styles:u({get:Un,getRaw:Gn,set:Vn,remove:$n}),attrs:u({get:Pn,set:Mn,remove:Wt,copyTo:function(e,n){En(n,zn(e))}}),insert:u({before:Rt,after:Dt,afterAll:kt,append:Xt,appendAll:It,prepend:Ot,wrap:At}),remove:u({unwrap:Mt,remove:Yt}),create:u({nu:Ve.fromTag,clone:function(e){return Ve.fromDom(e.dom.cloneNode(!1))},text:Ve.fromText}),query:u({comparePosition:function(e,n){return e.dom.compareDocumentPosition(n.dom)},prevSibling:un,nextSibling:cn}),property:u({children:ln,name:Ye,parent:rn,document:function(e){return tn(e).dom},isText:pn,isComment:Ze,isElement:gn,isSpecial:function(e){return T(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],Ye(e))},getLanguage:function(e){return gn(e)?Nn(e,"lang"):q.none()},getText:Et,setText:Nt,isBoundary:function(e){return!!gn(e)&&("body"===Ye(e)||T(Qt,Ye(e)))},isEmptyTag:function(e){return!!gn(e)&&T(["br","img","hr","input"],Ye(e))},isNonEditable:function(e){return gn(e)&&"false"===Pn(e,"contenteditable")}}),eq:ce,is:qe}}function er(e,n){return Hr(qr,(function(n,t){return e(t)}),n)}function nr(e){return On(e,"table")}function tr(e,n,t){function r(e){return function(n){return void 0!==t&&t(n)||ce(n,e)}}return ce(e,n)?q.some({boxes:q.some([e]),start:e,finish:n}):nr(e).bind((function(o){return nr(n).bind((function(u){if(ce(o,u))return q.some({boxes:(a=e,f=n,St(Kt(o),a,f)),start:e,finish:n});if(le(o,u)){var i=0<(c=sn(n,"td,th",r(o))).length?c[c.length-1]:n;return q.some({boxes:xt(o,e,o,n,u),start:e,finish:i})}if(le(u,o)){var c,l=0<(c=sn(e,"td,th",r(u))).length?c[c.length-1]:e;return q.some({boxes:xt(u,e,o,n,u),start:e,finish:l})}return Vr(qr,e,n,void 0).shared.bind((function(i){return In(i,"table",t).bind((function(t){var i=sn(n,"td,th",r(t)),c=0<i.length?i[i.length-1]:n,l=sn(e,"td,th",r(t)),a=0<l.length?l[l.length-1]:e;return q.some({boxes:xt(t,e,o,n,u),start:a,finish:c})}))}));var a,f}))}))}function rr(e,n){var t=dn(e,n);return 0<t.length?q.some(t):q.none()}function or(e,n,t){return kn(e,n).bind((function(n){return kn(e,t).bind((function(e){return er(nr,[n,e]).map((function(t){return{first:n,last:e,table:t}}))}))}))}function ur(e,n,t,r,o){return u=o,M(e,(function(e){return oe(e,u)})).bind((function(e){return u=n,i=t,rt(o=e).bind((function(e){var n=Kt(e),t=u,r=i;return $t.findItem(n,o,ce).bind((function(e){var o=0<t?e.row+e.rowspan-1:e.row,u=0<r?e.column+e.colspan-1:e.column;return $t.getAt(n,o+t,u+r).map((function(e){return e.element}))}))})).bind((function(e){return t=r,On(n=e,"table").bind((function(e){return kn(e,t).bind((function(e){return tr(e,n).bind((function(e){return e.boxes.map((function(n){return{boxes:n,start:e.start,finish:e.finish}}))}))}))}));var n,t}));var o,u,i}));var u}function ir(e,n,t){return or(e,n,t).bind((function(n){function t(n){return ce(e,n)}var r="thead,tfoot,tbody,table",o=On(n.first,r,t),u=On(n.last,r,t);return o.bind((function(e){return u.bind((function(t){return ce(e,t)?(o=n.table,u=n.first,i=n.last,c=Kt(o),Ct(r=c,u,i).bind((function(e){return function(e,n){for(var t=!0,r=b(yt,n),o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++)t=t&&$t.getAt(e,o,u).exists(r);return t?q.some(n):q.none()}(r,e)}))):q.none();var r,o,u,i,c}))}))}))}function cr(e,n,t,r){return e.fold(n,t,r)}function lr(e,n){return Ve.fromDom(e.dom.cloneNode(n))}function ar(e){return lr(e,!1)}function fr(e){return lr(e,!0)}function sr(e,n){var t=Ve.fromTag(n);return En(t,zn(e)),t}function mr(e,n){function t(t){var r=n(t);if(r<=0||null===r){var o=Un(t,e);return parseFloat(o)||0}return r}function r(e,n){return B(n,(function(n,t){var r=Un(e,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)}return{set:function(n,t){if(!p(t)&&!t.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+t);var r=n.dom;Fn(r)&&(r.style[e]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(e,n,t){var o=r(e,t);return o<n?n-o:0}}}function dr(){var e=He().browser;return e.isIE()||e.isEdge()}function gr(e,n,t){return r=Un(e,n),o=t,u=parseFloat(r),(isNaN(u)?q.none():q.some(u)).getOr(o);var r,o,u}function pr(e){return Un(e,"box-sizing")}function br(e,n,t,r){return n-gr(e,"padding-"+t,0)-gr(e,"padding-"+r,0)-gr(e,"border-"+t+"-width",0)-gr(e,"border-"+r+"-width",0)}function hr(e,n){var t=e.dom,r=t.getBoundingClientRect().width||t.offsetWidth;return"border-box"===n?r:br(e,r,"left","right")}function vr(e){return Jr.get(e)}function wr(e){return Jr.getOuter(e)}function yr(e,n){void 0===n&&(n=y);var t=e.grid,r=R(t.columns,i),o=R(t.rows,i);return D(r,(function(t){return eo((function(){return N(o,(function(n){return $t.getAt(e,n,t).filter((function(e){return e.column===t})).toArray()}))}),(function(e){return 1===e.colspan&&n(e.element)}),(function(){return $t.getAt(e,0,t)}))}))}function Cr(e){var n=e.grid,t=R(n.rows,i),r=R(n.columns,i);return D(t,(function(n){return eo((function(){return N(r,(function(t){return $t.getAt(e,n,t).filter((function(e){return e.row===n})).fold(u([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return $t.getAt(e,n,0)}))}))}function Sr(e,n){return function(t){return"rtl"===no(t)?n:e}}function Tr(e){return to.get(e)}function xr(e){return to.getOuter(e)}function Rr(e,n){return void 0!==e?e:void 0!==n?n:0}function Dr(e){var n=e.dom.ownerDocument,t=n.body,r=n.defaultView,o=n.documentElement;if(t===e.dom)return uo(t.offsetLeft,t.offsetTop);var u=Rr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Rr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Rr(o.clientTop,t.clientTop),l=Rr(o.clientLeft,t.clientLeft);return io(e).translate(i-l,u-c)}function Or(e,n){return{row:e,y:n}}function Ar(e,n){return{col:e,x:n}}function kr(e){return Dr(e).left+wr(e)}function Ir(e){return Dr(e).left}function Br(e,n){return Ar(e,Ir(n))}function Mr(e,n){return Ar(e,kr(n))}function Er(e){return Dr(e).top}function Pr(e,n){return Or(e,Er(n))}function Nr(e,n){return Or(e,Er(n)+xr(n))}function zr(e,n,t){if(0===t.length)return[];var r=D(t.slice(1),(function(n,t){return n.map((function(n){return e(t,n)}))})),o=t[t.length-1].map((function(e){return n(t.length-1,e)}));return r.concat([o])}function Lr(e){if(!f(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],t={};return O(e,(function(r,o){var u=Ue(r);if(1!==u.length)throw new Error("one and only one name per case");var i=u[0],c=r[i];if(void 0!==t[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!f(c))throw new Error("case arguments must be an array");n.push(i),t[i]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var u=t.length;if(u!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+u);return{fold:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(n.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+n.length);return n[o].apply(null,t)},match:function(e){var r=Ue(e);if(n.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+r.join(","));if(!z(n,(function(e){return T(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+n.join(", "));return e[i].apply(null,t)},log:function(e){console.log(e,{constructors:n,constructor:i,params:t})}}}})),t}var _r,Wr,jr,Fr=function(e,n,t){return n.bind((function(n){return t.filter(b(e.eq,n))}))},Hr=function(e,n,t){return 0<t.length?(r=e,o=n,u=t[0],I(t.slice(1),(function(e,n){var t=o(r,n);return Fr(r,e,t)}),o(r,u))):q.none();var r,o,u},Vr=function(e,n,t,r){function o(e){return E(e,r).fold((function(){return e}),(function(n){return e.slice(0,n+1)}))}void 0===r&&(r=w);var u=[n].concat(e.up().all(n)),i=[t].concat(e.up().all(t)),c=o(u),l=o(i),a=M(c,(function(n){return x(l,b(e.eq,n))}));return{firstpath:c,secondpath:l,shared:a}},qr=Zt(),Ur=rr,Gr=Lr([{none:[]},{multiple:["elements"]},{single:["element"]}]),$r=Gr.none,Kr=Gr.multiple,Xr=Gr.single,Yr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Jr=mr("width",(function(e){return e.dom.offsetWidth})),Qr=function(e){return hr(e,"content-box")},Zr=function(e){return dr()?hr(e,pr(e)):gr(e,"width",e.dom.offsetWidth)},eo=function(e,n,t){var r=e();return M(r,n).orThunk((function(){return q.from(r[0]).orThunk(t)})).map((function(e){return e.element}))},no=function(e){return"rtl"===Un(e,"direction")?"rtl":"ltr"},to=mr("height",(function(e){var n=e.dom;return Sn(e)?n.getBoundingClientRect().height:n.offsetHeight})),ro=function(e){return dr()?(t=pr(n=e),o=(r=n.dom).getBoundingClientRect().height||r.offsetHeight,"border-box"===t?o:br(n,o,"top","bottom")):gr(e,"height",e.dom.offsetHeight);var n,t,r,o},oo=function(e,n){return{left:e,top:n,translate:function(t,r){return oo(e+t,n+r)}}},uo=oo,io=function(e){var n,t=e.dom,r=t.ownerDocument.body;return r===t?uo(r.offsetLeft,r.offsetTop):Sn(e)?(n=t.getBoundingClientRect(),uo(n.left,n.top)):uo(0,0)},co={delta:i,positions:function(e){return zr(Pr,Nr,e)},edge:Er},lo=Sr({delta:i,edge:Ir,positions:function(e){return zr(Br,Mr,e)}},{delta:function(e){return-e},edge:kr,positions:function(e){return zr(Mr,Br,e)}}),ao={delta:function(e,n){return lo(n).delta(e,n)},positions:function(e,n){return lo(n).positions(e,n)},edge:function(e){return lo(e).edge(e)}},fo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},so=(jr=["Infinity",(_r="[0-9]+")+"\\."+mo(_r)+mo(Wr="[eE][+-]?[0-9]+"),"\\."+_r+mo(Wr),_r+mo(Wr)].join("|"),new RegExp("^([+-]?(?:"+jr+"))(.*)$"));function mo(e){return"(?:"+e+")?"}function go(e,n,t){var r=q.from(e.dom.parentElement).map(Ve.fromDom).getOrThunk((function(){return Tn(nn(e))}));return n(e)/t(r)*100}function po(e,n){Vn(e,"width",n+"px")}function bo(e,n){Vn(e,"width",n+"%")}function ho(e,n){Vn(e,"height",n+"px")}function vo(e){var n,t,r,o,u,i,c,l,a,f,s=ro(e)+"px";return s?(n=s,t=e,r=Tr,o=ho,f=parseFloat(n),ee(n,"%")&&"table"!==Ye(t)?(i=f,c=r,l=o,a=rt(u=t).map((function(e){var n=c(e);return Math.floor(i/100*n)})).getOr(i),l(u,a),a):f):Tr(e)}function wo(e,n){return Gn(e,n).orThunk((function(){return Nn(e,n).map((function(e){return e+"px"}))}))}function yo(e){return wo(e,"width")}function Co(e){return go(e,vr,Qr)}function So(e){return(jl(e)?vr:Zr)(e)}function To(e){return vo(n=e)/Xn(n,"rowspan");var n}function xo(e,n,t){Vn(e,"width",n+t)}function Ro(e){return go(e,vr,Qr)+"%"}function Do(e){return yo(e).getOrThunk((function(){return So(e)+"px"}))}function Oo(e){return wo(e,"height").getOrThunk((function(){return To(e)+"px"}))}function Ao(e,n,t,r,o,u){return e.filter(r).fold((function(){return u(function(e,n){if(n<0||n>=e.length-1)return q.none();var t=e[n].fold((function(){var t,r;return H((t=e.slice(0,n),(r=U.call(t,0)).reverse(),r),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return q.some({value:e,delta:0})})),r=e[n+1].fold((function(){return H(e.slice(n+1),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return q.some({value:e,delta:1})}));return t.bind((function(e){return r.map((function(n){var t=n.delta+e.delta;return Math.abs(n.value-e.value)/t}))}))}(t,n))}),(function(e){return o(e)}))}function ko(e,n,t,r){var o=yr(e),u=$t.hasColumns(e)?D($t.justColumns(e),(function(e){return q.from(e.element)})):o,c=[q.some(ao.edge(n))].concat(D(ao.positions(o,n),(function(e){return e.map((function(e){return e.x}))}))),l=h(Yn);return D(u,(function(e,n){return Ao(e,n,c,l,(function(e){return a=e,s=(f=He().browser).isChrome()||f.isFirefox(),!Hl(a)||s?t(e):Ao(null!=(u=o[n])?i(u):q.none(),n,c,l,(function(e){return r(q.some(vr(e)))}),r);var u,a,f,s}),r)}))}function Io(e){return e.map((function(e){return e+"px"})).getOr("")}function Bo(e,n,t){return ko(e,n,So,(function(e){return e.getOrThunk(t.minCellWidth)}))}function Mo(e,n,t,r,o){var u=Cr(e),i=[q.some(t.edge(n))].concat(D(t.positions(u,n),(function(e){return e.map((function(e){return e.y}))})));return D(u,(function(e,n){return Ao(e,n,i,h(Jn),r,o)}))}function Eo(e,n){return function(){return Sn(e)?n(e):parseFloat(Gn(e,"width").getOr("0"))}}function Po(e){var n=Eo(e,(function(e){return parseFloat(Ro(e))})),t=Eo(e,vr);return{width:n,pixelWidth:t,getWidths:function(n,t){return r=t,ko(n,e,Co,(function(e){return e.fold((function(){return r.minCellWidth()}),(function(e){return e/r.pixelWidth()*100}))}));var r},getCellDelta:function(e){return e/t()*100},singleColumnWidth:function(e,n){return[100-e]},minCellWidth:function(){return Ft()/t()*100},setElementWidth:bo,adjustTableWidth:function(t){var r=n();bo(e,r+t/100*r)},isRelative:!0,label:"percent"}}function No(e){var n=Eo(e,vr);return{width:n,pixelWidth:n,getWidths:function(n,t){return Bo(n,e,t)},getCellDelta:i,singleColumnWidth:function(e,n){return[Math.max(Ft(),e+n)-e]},minCellWidth:Ft,setElementWidth:po,adjustTableWidth:function(t){var r=n()+t;po(e,r)},isRelative:!1,label:"pixel"}}function zo(e,n){function t(e){return oe(e.element,n)}var r,o,u,i,c,l,a,f,s,m,d,g,p=fr(e),b=ct(p),h=Vl(e),v=$t.generate(b),w=(r=t,o=v.grid.columns,u=v.grid.rows,i=o,l=c=0,a=[],f=[],ae(v.access,(function(e){var n,t,o,s;a.push(e),r(e)&&(f.push(e),t=(n=e.row)+e.rowspan-1,s=(o=e.column)+e.colspan-1,n<u?u=n:c<t&&(c=t),o<i?i=o:l<s&&(l=s))})),{minRow:u,minCol:i,maxRow:c,maxCol:l,allCells:a,selectedCells:f}),y="th:not("+n+"),td:not("+n+")";return O(Vt(p,"th,td",(function(e){return oe(e,y)})),Yt),function(e,n,t,r){for(var o,u,i,c=n.grid.columns,l=n.grid.rows,a=0;a<l;a++)for(var f=!1,s=0;s<c;s++)a<t.minRow||a>t.maxRow||s<t.minCol||s>t.maxCol||($t.getAt(n,a,s).filter(r).isNone()?(o=f,u=e[a].element,i=Ve.fromTag("td"),Xt(i,Ve.fromTag("br")),(o?Xt:Ot)(u,i)):f=!0)}(b,v,w,t),s=p,m=w,d=v,g=function(e,n,t,r){if(0===r.minCol&&n.grid.columns===r.maxCol+1)return 0;var o=Bo(n,e,t),u=B(o,(function(e,n){return e+n}),0),i=B(o.slice(r.minCol,r.maxCol+1),(function(e,n){return e+n}),0)/u*t.pixelWidth()-t.pixelWidth();return t.getCellDelta(i)}(e,$t.fromTable(e),h,w),ae(d.columns,(function(e){(e.column<m.minCol||e.column>m.maxCol)&&Yt(e.element)})),O(k(Zn(s,"tr"),(function(e){return 0===e.dom.childElementCount})),Yt),m.minCol!==m.maxCol&&m.minRow!==m.maxRow||O(Zn(s,"th,td"),(function(e){Wt(e,"rowspan"),Wt(e,"colspan")})),Wt(s,Gt),Wt(s,"data-snooker-col-series"),Vl(s).adjustTableWidth(g),p}function Lo(e){return"img"===Ye(e)?1:Pt(e).fold((function(){return ln(e).length}),(function(e){return e.length}))}function _o(e){return Pt(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf("\xa0")})).isSome()||T(Gl,Ye(e))}function Wo(e){return n=_o,(t=function(e){for(var r=0;r<e.childNodes.length;r++){var o=Ve.fromDom(e.childNodes[r]);if(n(o))return q.some(o);var u=t(e.childNodes[r]);if(u.isSome())return u}return q.none()})(e.dom);var n,t}function jo(e){return $l(e,_o)}function Fo(e){return function(){var n=Ve.fromTag("td",e.dom);return Xt(n,Ve.fromTag("br",e.dom)),n}}function Ho(e){return function(){return Ve.fromTag("col",e.dom)}}function Vo(e){return function(){return Ve.fromTag("colgroup",e.dom)}}function qo(e){return function(){return Ve.fromTag("tr",e.dom)}}function Uo(e,n,t){var r,o,u=(It(o=sr(r=e,n),ln(fr(r))),o);return ae(t,(function(e,n){null===e?Wt(u,n):Mn(u,n,e)})),u}function Go(e){return e}function $o(e,n,t){function r(e,n){var t=e.element.dom,r=n.dom;Fn(t)&&Fn(r)&&(r.style.cssText=t.style.cssText),$n(n,"height"),1!==e.colspan&&$n(n,"width")}return{col:function(t){var o=Ve.fromTag(Ye(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:Vo(n),row:qo(n),cell:function(o){var u,i,c,l,a,f=Ve.fromTag(Ye(o.element),n.dom),s=t.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=0<s.length?(u=o.element,i=f,c=s,Wo(u).map((function(e){return I(sn(e,c.join(","),(function(e){return ce(e,u)})),(function(e,n){var t=ar(n);return Wt(t,"contenteditable"),Xt(e,t),t}),i)})).getOr(i)):f;return Xt(m,Ve.fromTag("br")),r(o,f),l=o.element,a=f,ae(Kl,(function(e,n){return Nn(l,n).filter((function(n){return T(e,n)})).each((function(e){return Mn(a,n,e)}))})),e(o.element,f),f},replace:Uo,colGap:Ho(n),gap:Fo(n)}}function Ko(e){return{col:Ho(e),colgroup:Vo(e),row:qo(e),cell:Fo(e),replace:Go,colGap:Ho(e),gap:Fo(e)}}function Xo(e){return D(e,Ve.fromDom)}function Yo(e){return Ve.fromDom(e.getBody())}function Jo(e){return e.getBoundingClientRect().width}function Qo(e){return e.getBoundingClientRect().height}function Zo(e){return function(n){return ce(n,Yo(e))}}function eu(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e}function nu(e){function n(e){return Wt(e,"data-mce-style")}Wt(e,"data-mce-style"),O(nt(e),n),O(tt(e),n),O(ot(e),n)}function tu(e){return Ve.fromDom(e.selection.getStart())}function ru(e){return cr(e.get(),u([]),i,_)}function ou(e,n,t){return{element:t,mergable:(u=n,i=Xl,cr(e.get(),q.none,(function(e){return e.length<=1?q.none():ir(u,i.firstSelectedSelector,i.lastSelectedSelector).map((function(n){return{bounds:n,cells:e}}))}),q.none)),unmergable:0<(o=ru(e)).length&&z(o,(function(e){return r(e,"rowspan")||r(e,"colspan")}))?q.some(o):q.none(),selection:ru(e)};function r(e,n){return Nn(e,n).exists((function(e){return 1<parseInt(e,10)}))}var o,u,i}function uu(e){return function(n,t){var r,o=Ye(n);return In("col"===o||"colgroup"===o?rt(r=n).bind((function(e){return Ur(e,Xl.firstSelectedSelector)})).fold(u(r),(function(e){return e[0]})):n,e,t)}}function iu(e,n,t){e.on("BeforeGetContent",(function(t){!0===t.selection&&cr(n.get(),o,(function(n){t.preventDefault(),rt(n[0]).map((function(e){var n=zo(e,"[data-mce-selected]");return nu(n),[n]})).each((function(n){var r;t.content="text"===t.format?D(n,(function(e){return e.dom.innerText})).join(""):(r=e,D(n,(function(e){return r.selection.serializer.serialize(e.dom,{})})).join(""))}))}),o)})),e.on("BeforeSetContent",(function(r){!0===r.selection&&!0===r.paste&&j(Ql(n)).each((function(n){rt(n).each((function(o){var u,i,c,l,a=k((u=r.content,(i=document.createElement("div")).innerHTML=u,ln(Ve.fromDom(i))),(function(e){return"meta"!==Ye(e)})),f=en("table");1===a.length&&f(a[0])&&(r.preventDefault(),c=Ko(Ve.fromDom(e.getDoc())),l={element:n,clipboard:a[0],generators:c},t.pasteCells(o,l).each((function(){e.focus()})))}))}))}))}function cu(e,n,t){for(var r=0,o=e;o<n;o++)r+=void 0!==t[o]?t[o]:0;return r}function lu(e,n,t){var r,o,u,i;O((r=e,o=n,$t.hasColumns(r)?(i=o,D($t.justColumns(r),(function(e,n){return{element:e.element,width:i[n],colspan:e.colspan}}))):(u=o,D($t.justCells(r),(function(e){var n=cu(e.column,e.column+e.colspan,u);return{element:e.element,width:n,colspan:e.colspan}})))),(function(e){t.setElementWidth(e.element,e.width)}))}function au(e,n,t,r,o){var i,c,l,a,f,s,m,d,g,p,b=$t.fromTable(e),h=o.getCellDelta(n),v=o.getWidths(b,o),w=t===b.grid.columns-1,y=r.clampTableDelta(v,t,h,o.minCellWidth(),w),C=(c=t,l=y,a=o,f=r,d=(i=v).slice(0),m=c,g=0===(s=i).length?ea.none():1===s.length?ea.only(0):0===m?ea.left(0,1):m===s.length-1?ea.right(m-1,m):0<m&&m<s.length-1?ea.middle(m-1,m,m+1):ea.none(),p=u(D(d,u(0))),g.fold(p,(function(e){return a.singleColumnWidth(d[e],l)}),(function(e,n){return f.calcLeftEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)}),(function(e,n,t){return f.calcMiddleDeltas(d,e,n,t,l,a.minCellWidth(),a.isRelative)}),(function(e,n){return f.calcRightEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)})));lu(b,D(C,(function(e,n){return e+v[n]})),o),r.resizeTable(o.adjustTableWidth,y,w)}function fu(e){return D(e,u(0))}function su(e,n,t,r,o){return o(e.slice(0,n)).concat(r).concat(o(e.slice(t)))}function mu(e){return function(n,t,r,o){if(e(r)){var u=Math.max(o,n[t]-Math.abs(r)),i=Math.abs(u-n[t]);return 0<=r?i:-i}return r}}function du(){function e(e,n,t,r){var o=(100+t)/100,u=Math.max(r,(e[n]+t)/o);return D(e,(function(e,t){return(t===n?u:e/o)-e}))}function n(n,t,r,o,u,i){return i?e(n,t,o,u):(a=r,f=na(c=n,l=t,o,u),su(c,l,a+1,[f,0],fu));var c,l,a,f}return{resizeTable:function(e,n){return e(n)},clampTableDelta:na,calcLeftEdgeDeltas:n,calcMiddleDeltas:function(e,t,r,o,u,i,c){return n(e,r,o,u,i,c)},calcRightEdgeDeltas:function(n,t,r,o,u,i){if(i)return e(n,r,o,u);var c=na(n,r,o,u);return fu(n.slice(0,r)).concat([c])},calcRedestributedWidths:function(e,n,t,r){if(r){var o=(n+t)/n,u=D(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:u}}return{delta:t,newSizes:e}}}}function gu(){function e(e,n,t,r,o){var u=ta(e,0<=r?t:n,r,o);return su(e,n,t+1,[u,-u],fu)}return{resizeTable:function(e,n,t){t&&e(n)},clampTableDelta:function(e,n,t,r,o){if(o){if(0<=t)return t;var u=B(e,(function(e,n){return e+n-r}),0);return Math.max(-u,t)}return na(e,n,t,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(n,t,r,o,u,i){return e(n,r,o,u,i)},calcRightEdgeDeltas:function(e,n,t,r,o,i){return i?fu(e):D(e,u(r/e.length))},calcRedestributedWidths:function(e,n,t,r){return{delta:0,newSizes:e}}}}function pu(e,n,t){var r=t.substring(0,t.length-e.length),o=parseFloat(r);return r===o.toString()?n(o):ra.invalid(t)}function bu(e,n,t){var r,o,i,c,l=oa.from(t),a=z(e,(function(e){return"0px"===e}))?(r=e.length,o=l.fold((function(){return u("")}),(function(e){return u(e/r+"px")}),(function(){return u(100/r+"%")})),R(r,o)):(i=e,c=n,l.fold((function(){return i}),(function(e){return t=(n=e)/c,D(i,(function(e){return oa.from(e).fold((function(){return e}),(function(e){return e*t+"px"}),(function(e){return e/100*n+"px"}))}));var n,t}),(function(e){return n=c,D(i,(function(e){return oa.from(e).fold((function(){return e}),(function(e){return e/n*100+"%"}),(function(e){return e+"%"}))}));var n})));return ua(a)}function hu(e,n){return 0===e.length?n:I(e,(function(e,n){return oa.from(n).fold(u(0),i,i)+e}),0)}function vu(e){return ia(e).fold(u("px"),u("px"),u("%"))}function wu(e,n,t){var r=$t.fromTable(e),o=r.all,u=$t.justCells(r),i=$t.justColumns(r);n.each((function(n){var t,o,c,l,a=vu(n),f=vr(e),s=bu(ko(r,e,Do,Io),f,n);$t.hasColumns(r)?(c=s,l=a,O(i,(function(e,n){var t=hu([c[n]],Ft());Vn(e.element,"width",t+l)}))):(t=s,o=a,O(u,(function(e){var n=hu(t.slice(e.column,e.colspan+e.column),Ft());Vn(e.element,"width",n+o)}))),Vn(e,"width",n)})),t.each((function(n){var t=vu(n),i=Tr(e),c=bu(Mo(r,e,co,Oo,Io),i,n),l=o,a=t;O(u,(function(e){var n=hu(c.slice(e.row,e.rowspan+e.row),Ht());Vn(e.element,"height",n+a)})),O(l,(function(e,n){Vn(e.element,"height",c[n])})),Vn(e,"height",n)}))}function yu(e){return $t.fromTable(e).grid}function Cu(e){var n=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");n.push(e)},unbind:function(e){n=k(n,(function(n){return n!==e}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o={};O(e,(function(e,n){o[e]=t[n]})),O(n,(function(e){e(o)}))}}}function Su(e){return{registry:fe(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:fe(e,(function(e){return e.trigger}))}}function Tu(e){return e.slice(0).sort()}function xu(e,n){var t=k(n,(function(n){return!T(e,n)}));0<t.length&&function(){throw new Error("Unsupported keys for object: "+Tu(t).join(", "))}()}function Ru(e){return function(e,n,t){if(0===n.length)throw new Error("You must specify at least one required field.");var r;return function(e,n){if(!f(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");O(n,(function(n){if(!l(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")}))}("required",n),M(r=Tu(n),(function(e,n){return n<r.length-1&&e===r[n+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Ue(r);z(n,(function(e){return T(o,e)}))||function(e,n){throw new Error("All required keys ("+Tu(e).join(", ")+") were not specified. Specified keys were: "+Tu(n).join(", ")+".")}(n,o),e(n,o);var u=k(n,(function(e){return!t.validate(r[e],e)}));return 0<u.length&&function(e,n){throw new Error("All values need to be of type: "+n+". Keys ("+Tu(e).join(", ")+") were not.")}(u,t.label),r}}(xu,e,{validate:g,label:"function"})}function Du(){var e,n,t={onEvent:o,reset:o,events:Su({move:Cu(["info"])}).registry},r=(e=q.none(),{onEvent:function(t,r){r.extract(t).each((function(t){var o=r,u=t,i=e.map((function(e){return o.compare(e,u)}));e=q.some(u),i.each((function(e){n.trigger.move(e)}))}))},reset:function(){e=q.none()},events:(n=Su({move:Cu(["info"])})).registry}),u=t;return{on:function(){u.reset(),u=r},off:function(){u.reset(),u=t},isOn:function(){return u===r},onEvent:function(e,n){u.onEvent(e,n)},events:r.events}}function Ou(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var o,u,i=Ve.fromDom(function(e){if(wn()&&r(e.target)){var n=Ve.fromDom(e.target);if(gn(n)&&Cn(n)&&e.composed&&e.composedPath){var t=e.composedPath();if(t)return j(t)}}return q.from(e.target)}(e).getOr(e.target)),c=(o=t,u=n,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(u.apply(null,e))});return{target:i,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:c,raw:e}}function Au(e,n,t){return o=n,u=!1,i=sa,c=t,l=function(e){i(e)&&c(Ou(e))},(r=e).dom.addEventListener(o,l,u),{unbind:b(fa,r,o,l,u)};var r,o,u,i,c,l}function ku(e){return void 0!==e.dom.classList}function Iu(e,n){return o=n,Mn(e,t="class",(void 0===(r=Pn(e,t))||""===r?[]:r.split(" ")).concat([o]).join(" ")),1;var t,r,o}function Bu(e,n){ku(e)?e.dom.classList.add(n):Iu(e,n)}function Mu(e,n){return ku(e)&&e.dom.classList.contains(n)}function Eu(e){var n=e.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}}function Pu(e){return In(e,"[contenteditable]")}function Nu(e,n){return void 0===n&&(n=!1),!He().browser.isIE()&&Sn(e)?e.dom.isContentEditable:Pu(e).fold(u(n),(function(e){return"true"===pa(e)}))}function zu(e){O(dn(e.parent(),"."+ha),Yt)}function Lu(e,n,t){var r=e.origin();O(n,(function(n){n.each((function(n){var o=t(r,n);Bu(o,ha),Xt(e.parent(),o)}))}))}function _u(e,n,t,r,o){var u,i,c,l,a,f=Dr(t),s=n.isResizable,m=0<r.length?co.positions(r,t):[],d=0<m.length?(u=s,N(e.all,(function(e,n){return u(e.element)?[n]:[]}))):[],g=k(m,(function(e,n){return x(d,(function(e){return n===e}))}));i=n,c=g,l=f,a=wr(t),Lu(i,c,(function(e,n){var t,r,o,u,i,c=(t=n.row,r=l.left-e.left,o=n.y-e.top,u=a,qn(i=Ve.fromTag("div"),{position:"absolute",left:r+"px",top:o-3.5+"px",height:"7px",width:u+"px"}),En(i,{"data-row":t,role:"presentation"}),i);return Bu(c,va),c}));var p,b,h,v,w,y,C,S=0<o.length?ao.positions(o,t):[],T=0<S.length?(b=s,h=[],R((p=e).grid.columns,(function(e){$t.getColumnAt(p,e).map((function(e){return e.element})).forall(b)&&h.push(e)})),k(h,(function(e){return z($t.filterItems(p,(function(n){return n.column===e})),(function(e){return b(e.element)}))}))):[],D=k(S,(function(e,n){return x(T,(function(e){return n===e}))}));v=n,w=D,y=f,C=xr(t),Lu(v,w,(function(e,n){var t,r,o,u,i,c=(t=n.col,r=n.x-e.left,o=y.top-e.top,u=C,qn(i=Ve.fromTag("div"),{position:"absolute",left:r-3.5+"px",top:o+"px",height:u+"px",width:"7px"}),En(i,{"data-column":t,role:"presentation"}),i);return Bu(c,wa),c}))}function Wu(e,n){var t;zu(e),e.isResizable(n)&&_u(t=$t.fromTable(n),e,n,Cr(t),yr(t))}function ju(e,n){O(dn(e.parent(),"."+ha),n)}function Fu(e){ju(e,(function(e){Vn(e,"display","none")}))}function Hu(e){ju(e,(function(e){Vn(e,"display","block")}))}function Vu(e){function n(e,n){return q.from(Pn(e,n))}var t,r,o,u,i,c,l=(u=Su({drag:Cu(["xDelta","yDelta","target"])}),i=q.none(),(c={mutate:function(e,n){o.trigger.drag(e,n)},events:(o=Su({drag:Cu(["xDelta","yDelta"])})).registry}).events.drag.bind((function(e){i.each((function(n){u.trigger.drag(e.xDelta,e.yDelta,n)}))})),{assign:function(e){i=q.some(e)},get:function(){return i},mutate:c.mutate,events:u.registry}),a=(r=void 0!==(t={}).mode?t.mode:ga,function(e,n,t){function r(){d.stop(),l.isOn()&&(l.off(),c.trigger.stop())}var o,u,i=!1,c=Su({start:Cu([]),stop:Cu([])}),l=Du(),a=(o=r,u=null,{cancel:f,throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];f(),u=setTimeout((function(){u=null,o.apply(null,e)}),200)}});function f(){s(u)||(clearTimeout(u),u=null)}function m(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];i&&e.apply(null,n)}}l.events.move.bind((function(t){n.mutate(e,t.info)}));var d=n.sink(aa({forceDrop:r,drop:m(r),move:m((function(e){a.cancel(),l.onEvent(e,n)})),delayDrop:m(a.throttle)}),t);return{element:d.element,go:function(e){d.start(e),l.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}}(l,r,t)),f=q.none();function m(e,n){return Qn(e,n)-Kn(e,"data-initial-"+n,0)}function d(n,t){v.trigger.startAdjust(),l.assign(n),Mn(n,"data-initial-"+t,Qn(n,t)),Bu(n,ya),Vn(n,"opacity","0.2"),a.go(e.parent())}function g(n){return ce(n,e.view())}l.events.drag.bind((function(e){n(e.target,"data-row").each((function(n){var t=Qn(e.target,"top");Vn(e.target,"top",t+e.yDelta+"px")})),n(e.target,"data-column").each((function(n){var t=Qn(e.target,"left");Vn(e.target,"left",t+e.xDelta+"px")}))})),a.events.stop.bind((function(){l.get().each((function(t){f.each((function(r){n(t,"data-row").each((function(e){var n=m(t,"top");Wt(t,"data-initial-top"),v.trigger.adjustHeight(r,n,parseInt(e,10))})),n(t,"data-column").each((function(e){var n=m(t,"left");Wt(t,"data-initial-left"),v.trigger.adjustWidth(r,n,parseInt(e,10))})),Wu(e,r)}))}))}));var p=Au(e.parent(),"mousedown",(function(e){Mu(e.target,va)&&d(e.target,"top"),Mu(e.target,wa)&&d(e.target,"left")})),h=Au(e.view(),"mouseover",(function(n){In(n.target,"table",g).filter(Nu).fold((function(){Sn(n.target)&&zu(e)}),(function(n){f=q.some(n),Wu(e,n)}))})),v=Su({adjustHeight:Cu(["table","delta","row"]),adjustWidth:Cu(["table","delta","column"]),startAdjust:Cu([])});return{destroy:function(){p.unbind(),h.unbind(),a.destroy(),zu(e)},refresh:function(n){Wu(e,n)},on:a.on,off:a.off,hideBars:b(Fu,e),showBars:b(Hu,e),events:v.registry}}function qu(e,n){return e.fire("newrow",{node:n})}function Uu(e,n){return e.fire("newcell",{node:n})}function Gu(e,n,t){e.fire("TableModified",K(K({},t),{table:n}))}function $u(e){return e.getParam("table_sizing_mode","auto")}function Ku(e){return e.getParam("table_responsive_width")}function Xu(e){return e.getParam("table_border_widths",Ra,"array")}function Yu(e){return e.getParam("table_border_styles",Da,"array")}function Ju(e){return e.getParam("table_default_attributes",Oa,"object")}function Qu(e){return e.getParam("table_default_styles",function(e){var n;if(ka(e)){var t=e.dom,r=null!==(n=t.getParent(e.selection.getStart(),t.isBlock))&&void 0!==n?n:e.getBody(),o=Qr(Ve.fromDom(r));return K(K({},xa),{width:o+"px"})}return Ia(e)?se(xa,(function(e,n){return"width"!==n})):xa}(e),"object")}function Zu(e){return e.getParam("table_cell_advtab",!0,"boolean")}function ei(e){return e.getParam("table_row_advtab",!0,"boolean")}function ni(e){return e.getParam("table_advtab",!0,"boolean")}function ti(e){return e.getParam("table_style_by_css",!1,"boolean")}function ri(e){return e.getParam("table_cell_class_list",[],"array")}function oi(e){return e.getParam("table_class_list",[],"array")}function ui(e){return"relative"===$u(e)||!0===Ku(e)}function ii(e){var n="section",t=e.getParam("table_header_type",n,"string");return T(["section","cells","sectionCells","auto"],t)?t:n}function ci(e){var n=e.getParam("table_column_resizing",Aa,"string");return M(["preservetable","resizetable"],(function(e){return e===n})).getOr(Aa)}function li(e){return"preservetable"===ci(e)}function ai(e){return"resizetable"===ci(e)}function fi(e){var n=e.getParam("table_clone_elements");return l(n)?q.some(n.split(/[ ,]/)):Array.isArray(n)?q.some(n):q.none()}function si(e){return e.getParam("table_background_color_map",[],"array")}function mi(e){return e.getParam("table_border_color_map",[],"array")}function di(e,n){return(ui(e)?Ul:ka(e)?ql:Vl)(n)}function gi(e){Wt(e,"width")}function pi(e){return"false"!==Pn(e,"data-mce-resize")}function bi(e){function n(e){return"TABLE"===e.nodeName}function t(n){return di(e,n)}function r(){return(li(e)?gu:du)()}var o,i,c=q.none(),a=q.none(),f=q.none();return e.on("init",(function(){var n,o,i,s,m,d,g,p,b,h,v,w,y,C,S=(o=pi,(n=e).inline?(d=Yo(n),qn(p=Ve.fromTag("div"),{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Xt(Tn(Ve.fromDom(document)),p),g=o,{parent:u(p),view:u(d),origin:u(uo(0,0)),isResizable:g}):Il(Ve.fromDom(n.getDoc()),o));f=q.some(S),m=e.getParam("object_resizing",!0),(l(m)?"table"===m:m)&&e.getParam("table_resize_bars",!0,"boolean")&&(i=r(),b=i,h=t,v=co,w=ao,y=Vu(S),C=Su({beforeResize:Cu(["table","type"]),afterResize:Cu(["table","type"]),startDrag:Cu([])}),y.events.adjustHeight.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"row");var t,r,o,u,i,c,l,a,f,s=v.delta(e.delta,n);t=n,r=s,o=e.row,u=v,l=$t.fromTable(t),a=D(Mo(l,t,u,To,(function(e){return e.getOrThunk(Ht)})),(function(e,n){return o===n?Math.max(r+e,Ht()):e})),i=a,f=D($t.justCells(l),(function(e){var n=cu(e.row,e.row+e.rowspan,i);return{element:e.element,height:n,rowspan:e.rowspan}})),O((c=a,D(l.all,(function(e,n){return{element:e.element,height:c[n]}}))),(function(e){ho(e.element,e.height)})),O(f,(function(e){ho(e.element,e.height)})),ho(t,I(a,(function(e,n){return e+n}),0)),C.trigger.afterResize(n,"row")})),y.events.startAdjust.bind((function(e){C.trigger.startDrag()})),y.events.adjustWidth.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"col");var t=w.delta(e.delta,n),r=h(n);au(n,t,e.column,b,r),C.trigger.afterResize(n,"col")})),(s={on:y.on,off:y.off,hideBars:y.hideBars,showBars:y.showBars,destroy:y.destroy,events:C.registry}).on(),s.events.startDrag.bind((function(n){c=q.some(e.selection.getRng())})),s.events.beforeResize.bind((function(n){var t,r=n.table.dom,o=e,u=Jo(t=r),i=Qo(r),c=Pa+n.type;o.fire("ObjectResizeStart",{target:t,width:u,height:i,origin:c})})),s.events.afterResize.bind((function(n){var t,r,o,u,i,l=n.table,a=l.dom;nu(l),c.each((function(n){e.selection.setRng(n),e.focus()})),t=e,o=Jo(r=a),u=Qo(a),i=Pa+n.type,t.fire("ObjectResized",{target:r,width:o,height:u,origin:i}),e.undoManager.add()})),a=q.some(s))})),e.on("ObjectResizeStart",(function(t){var r,u,c,l,a=t.target;n(a)&&(r=Ve.fromDom(a),O(e.dom.select(".mce-clonedresizable"),(function(n){e.dom.addClass(n,"mce-"+ci(e)+"-columns")})),!Ml(r)&&ka(e)?Ma(r):!Bl(r)&&ui(e)&&Ba(r),El(r)&&Ae(t.origin,Pa)&&Ba(r),o=t.width,i=Ia(e)?"":(l=(u=e).dom.getStyle(c=a,"width")||u.dom.getAttrib(c,"width"),q.from(l).filter(ne).getOr("")))})),e.on("ObjectResized",(function(u){var c,l,a,f,s,m,d,g,p,b,h=u.target;n(h)&&(c=Ve.fromDom(h),l=u.origin,Ae(l,"corner-")&&(a=c,f=u.width,b=ee(l,"e"),""===i&&Ba(a),f!==o&&""!==i?(Vn(a,"width",i),s=r(),m=t(a),d=li(e)||b?yu(a).columns-1:0,au(a,f-o,d,s,m)):/^(\d+(\.\d+)?)%$/.test(i)&&Vn(a,"width",f*parseFloat(i.replace("%",""))/o+"%"),/^(\d+(\.\d+)?)px$/.test(i)&&(p=$t.fromTable(g=a),$t.hasColumns(p)||O(nt(g),(function(e){Vn(e,"width",Un(e,"width")),Wt(e,"width")})))),nu(c),Gu(e,c.dom,Ca))})),e.on("SwitchMode",(function(){a.each((function(n){e.mode.isReadOnly()?n.hideBars():n.showBars()}))})),{lazyResize:function(){return a},lazyWire:function(){return f.getOr(Il(Ve.fromDom(e.getBody()),pi))},destroy:function(){a.each((function(e){e.destroy()})),f.each((function(n){var t=n;e.inline&&Yt(t.parent())}))}}}function hi(e,n){return{element:e,offset:n}}function vi(e,n){return(e.property().isText(n)?e.property().getText(n):e.property().children(n)).length}function wi(e,n){1===Xn(e,"colspan")&&yo(e).bind((function(e){return n=["fixed","relative","empty"],q.from(so.exec(e)).bind((function(e){var t=Number(e[1]),r=e[2],o=r;return x(n,(function(e){return x(fo[e],(function(e){return o===e}))}))?q.some({value:t,unit:r}):q.none()}));var n})).each((function(t){var r=t.value/2;xo(e,r,t.unit),xo(n,r,t.unit)}))}function yi(e){return z(e,(function(e){return Wa(e.element)}))}function Ci(e){var n="thead"===e.section,t=Ln(ja(e.cells),"th");return n||t?{type:"header",subType:n&&t?"sectionCells":n?"section":"cells"}:"tfoot"===e.section?{type:"footer"}:{type:"body"}}function Si(e,n,t){return we(t(e.element,n),!0,e.isLocked)}function Ti(e,n){return e.section!==n?ye(e.element,e.cells,n,e.isNew):e}function xi(){return{transformRow:Ti,transformCell:function(e,n,t){var r,o,u=t(e.element,n);return we("td"!==Ye(u)?(o=sr(r=u,"td"),Rt(r,o),It(o,ln(r)),Yt(r),o):u,e.isNew,e.isLocked)}}}function Ri(){return{transformRow:Ti,transformCell:Si}}function Di(){return{transformRow:function(e,n){return Ti(e,"thead"===n?"tbody":n)},transformCell:Si}}function Oi(e,n,t,r){t===r?Wt(e,n):Mn(e,n,t)}function Ai(e,n,t){F(mn(e,n)).fold((function(){return Ot(e,t)}),(function(e){return Dt(e,t)}))}function ki(e,n){function t(n,t){var r,i,c;It((Bt(c=An(r=e,i=t).getOrThunk((function(){var e=Ve.fromTag(i,nn(r).dom);return"thead"===i?Ai(r,"caption,colgroup",e):"colgroup"===i?Ai(r,"caption",e):Xt(r,e),e}))),c),("colgroup"===t?function(e){return N(e,(function(e){return D(e.cells,(function(e){return Oi(e.element,"span",e.colspan,1),e.element}))}))}:function(e){return D(e,(function(e){e.isNew&&o.push(e.element);var n=e.element;return Bt(n),O(e.cells,(function(e){e.isNew&&u.push(e.element),Oi(e.element,"colspan",e.colspan,1),Oi(e.element,"rowspan",e.rowspan,1),Xt(n,e.element)})),n}))})(n))}function r(n,r){0<n.length?t(n,r):An(e,r).each(Yt)}var o=[],u=[],i=[],c=[],l=[],a=[];return O(n,(function(e){switch(e.section){case"thead":i.push(e);break;case"tbody":c.push(e);break;case"tfoot":l.push(e);break;case"colgroup":a.push(e)}})),r(a,"colgroup"),r(i,"thead"),r(c,"tbody"),r(l,"tfoot"),{newRows:o,newCells:u}}function Ii(e,n){if(0===e.length)return 0;var t=e[0];return E(e,(function(e){return!n(t.element,e.element)})).getOr(e.length)}function Bi(e,n){var t=D(e,(function(e){return D(e.cells,w)}));return D(e,(function(r,o){var u=N(r.cells,(function(r,u){if(!1!==t[o][u])return[];var i,c,l,a,f,s,m,d,g=(l=u,a=n,m=(i=e)[c=o],d="colgroup"===m.section,{colspan:Ii(m.cells.slice(l),a),rowspan:d?1:Ii((f=i.slice(c),s=l,D(f,(function(e){return st(e,s)}))),a)});return function(e,n,r,o){for(var u=e;u<e+r;u++)for(var i=n;i<n+o;i++)t[u][i]=!0}(o,u,g.rowspan,g.colspan),[{element:r.element,rowspan:g.rowspan,colspan:g.colspan,isNew:r.isNew}]}));return{element:r.element,cells:u,section:r.section,isNew:r.isNew}}))}function Mi(e,n,t){var r=[];O(e.colgroups,(function(o){for(var u=[],i=0;i<e.grid.columns;i++){var c=$t.getColumnAt(e,i).map((function(e){return we(e.element,t,!1)})).getOrThunk((function(){return we(n.colGap(),!0,!1)}));u.push(c)}r.push(ye(o.element,u,"colgroup",t))}));for(var o=0;o<e.grid.rows;o++){for(var u=[],i=0;i<e.grid.columns;i++){var c=$t.getAt(e,o,i).map((function(e){return we(e.element,t,e.isLocked)})).getOrThunk((function(){return we(n.gap(),!0,!1)}));u.push(c)}var l=e.all[o],a=ye(l.element,u,l.section,t);r.push(a)}return r}function Ei(e){return Bi(e,ce)}function Pi(e,n){return H(e.all,(function(e){return M(e.cells,(function(e){return ce(n,e.element)}))}))}function Ni(e,n,t){var r=_n(D(n.selection,(function(n){return et(n).bind((function(n){return Pi(e,n)})).filter(t)})));return jn(0<r.length,r)}function zi(e,n,t,r,o){return function(u,i,c,l,a){var f=$t.fromTable(i),s=q.from(null==a?void 0:a.section).getOrThunk(Pl);return n(f,c).map((function(n){var t=Mi(f,l,!1),r=e(t,n,ce,o(l),s),u=ht(r.grid);return{info:n,grid:Ei(r.grid),cursor:r.cursor,lockedColumns:u}})).bind((function(e){var n=ki(i,e.grid),o=q.from(null==a?void 0:a.sizing).getOrThunk((function(){return Vl(i)})),c=q.from(null==a?void 0:a.resize).getOrThunk(gu);return t(i,e.grid,e.info,{sizing:o,resize:c,section:s}),r(i),Wu(u,i),Wt(i,Gt),0<e.lockedColumns.length&&Mn(i,Gt,e.lockedColumns.join(",")),q.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})}))}}function Li(e,n){return Ni(e,n,y).map((function(e){return{cells:e,generators:n.generators,clipboard:n.clipboard}}))}function _i(e,n){return Ni(e,n,y)}function Wi(e,n){return Ni(e,n,(function(e){return!e.isLocked}))}function ji(e,n){return z(n,(function(n){return Pi(e,n).exists((function(e){return!e.isLocked}))}))}function Fi(e,n){return n.mergable.filter((function(n){return ji(e,n.cells)}))}function Hi(e,n){return n.unmergable.filter((function(n){return ji(e,n)}))}function Vi(e,n,t,r){for(var o=gt(e).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<dt(o[0]);c++){var l=o[i],a=st(l,c),f=t(a.element,n);!0===f&&!1===u?ft(l,c,we(r(),!0,a.isLocked)):!0===f&&(u=!1)}return e}function qi(e,n,t,r){var o,u,i=gt(e).rows;return 0<n&&n<i.length&&(o=i[n-1].cells,u=t,O(B(o,(function(e,n){return x(e,(function(e){return u(e.element,n.element)}))?e:e.concat([n])}),[]),(function(e){for(var o=q.none(),u=n;u<i.length;u++)for(var c=0;c<dt(i[0]);c++)!function(n){var c=i[u],l=st(c,n);t(l.element,e.element)&&(o=o.isNone()?q.some(r()):o).each((function(e){ft(c,n,we(e,!0,l.isLocked))}))}(c)}))),e}function Ui(e,n){return{rowDelta:0,colDelta:dt(e[0])-dt(n[0])}}function Gi(e,n){return{rowDelta:e.length-n.length,colDelta:0}}function $i(e,n,t,r){var o="colgroup"===n.section?t.col:t.cell;return R(e,(function(e){return we(o(),!0,r(e))}))}function Ki(e,n,t,r){var o=e[e.length-1];return e.concat(R(n,(function(){var e="colgroup"===o.section?t.colgroup:t.row,n=pt(o,e,i),u=$i(n.cells.length,n,t,(function(e){return Ke(r,e.toString())}));return Ut(n,u)})))}function Xi(e,n,t,r){return D(e,(function(e){var o=$i(n,e,t,w);return lt(e,r,o)}))}function Yi(e,n,t){var r=n.colDelta<0?Xi:i,o=n.rowDelta<0?Ki:i,u=ht(e),c=dt(e[0]),l=x(u,(function(e){return e===c-1})),a=r(e,Math.abs(n.colDelta),t,l?c-1:c),f=ht(a);return o(a,Math.abs(n.rowDelta),t,L(f,y))}function Ji(e,n,t){return k(t,(function(t){return t>=e.column&&t<=dt(n[0])+e.column}))}function Qi(e,n,t,r,o){var u,i,c,l=ht(n),a=(u=e,i=l,c=dt(n[0]),{row:gt(n).cols.length+u.row,column:M(R(c-u.column,(function(e){return e+u.column})),(function(e){return z(i,(function(n){return n!==e}))})).getOr(c-1)}),f=gt(t).rows,s=Ji(a,f,l);return function(e,n,t){if(e.row>=n.length||e.column>dt(n[0]))return Ga.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=n.slice(e.row),o=r[0].cells.slice(e.column),u=dt(t[0]),i=t.length;return Ga.value({rowDelta:r.length-i,colDelta:o.length-u})}(a,n,f).map((function(e){var t=K(K({},e),{colDelta:e.colDelta-s.length}),u=Yi(n,t,r),i=ht(u),c=Ji(a,f,i);return function(e,n,t,r,o,u){for(var i,c,l,a,f,s=e.row,m=e.column,d=s+t.length,g=m+dt(t[0])+u.length,p=L(u,y),h=s;h<d;h++)for(var v,w,C,S=0,T=m;T<g;T++)p[T]?S++:(l=T,a=void 0,a=b(o,st((i=n)[c=h],l).element),f=i[c],1<i.length&&1<dt(f)&&(0<l&&a(mt(f,l-1))||l<f.cells.length-1&&a(mt(f,l+1))||0<c&&a(mt(i[c-1],l))||c<i.length-1&&a(mt(i[c+1],l)))&&Vi(n,mt(n[h],T),o,r.cell),w=(v=st(t[h-s],T-m-S)).element,C=r.replace(w),ft(n[h],T,we(C,!0,v.isLocked)));return n}(a,u,f,r,o,c)}))}function Zi(e,n,t,r,o){var u=e,i=o,c=r.cell;0<u&&u<n[0].cells.length&&O(n,(function(e){var n=e.cells[u-1],t=e.cells[u];i(t.element,n.element)&&ft(e,u,we(c(),!0,t.isLocked))}));var l=Yi(t,Gi(t,n),r);return D(Yi(n,Gi(n,l),r),(function(n,t){return lt(n,e,l[t].cells)}))}function ec(e,n,t,r,o){qi(n,e,o,r.cell);var u,i,c=ht(n),l=Ui(n,t),a=Yi(n,K(K({},l),{colDelta:l.colDelta-c.length}),r),f=gt(a),s=f.cols,m=f.rows,d=ht(a),g=Ui(t,n),p=K(K({},g),{colDelta:g.colDelta+d.length}),b=Yi((u=r,i=d,D(t,(function(e){return B(i,(function(n,t){return at(n,t,$i(1,e,u,y)[0])}),e)}))),p,r);return s.concat(m.slice(0,e)).concat(b).concat(m.slice(e,m.length))}function nc(e,n,t,r,o){var u,i,c,l,a=gt(e),f=a.rows,s=a.cols,m=f.slice(0,n),d=f.slice(n),g=(u=f[t],i=function(e,t){return 0<n&&n<f.length&&r(mt(f[n-1],t),mt(f[n],t))?st(f[n],t):we(o(e.element,r),!0,e.isLocked)},c=r,l=o,pt(u,(function(e){return l(e,c)}),i));return s.concat(m).concat([g]).concat(d)}function tc(e,n,t,r,o){return D(e,(function(e){var u,i,c=0<n&&n<dt(e)&&r(mt(e,n-1),mt(e,n)),l=(u=e.section,i=o,"colgroup"!==u&&c?st(e,n):we(i(st(e,t).element,r),!0,!1));return at(e,n,l)}))}function rc(e,n,t,r){return void 0!==mt((u=e)[i=n],t)&&0<i&&r(mt(u[i-1],t),mt(u[i],t))||(o=e[n],0<t&&r(mt(o,t-1),mt(o,t)));var o,u,i}function oc(e,n,t,r){function o(e){return("row"===e?Jn:Yn)(n)?e+"group":e}return e?Wa(n)?o(t):null:r&&Wa(n)?o("row"===t?"col":"row"):null}function uc(e,n,t){return we(t(e.element,n),!0,e.isLocked)}function ic(e,n,t,r,o,u,i){return D(e,(function(e,c){return a=function(e,l){if(f=e,x(n,(function(e){return t(f.element,e.element)}))){var a=i(e,c,l)?o(e,t,r):e;return u(a,c,l).each((function(e){var n=a.element;ae({scope:q.from(e)},(function(e,t){e.fold((function(){Wt(n,t)}),(function(e){Bn(n.dom,t,e)}))}))})),a}return e;var f},f=D((l=e).cells,a),ye(l.element,f,l.section,l.isNew);var l,a,f}))}function cc(e,n,t){return N(e,(function(r,o){return rc(e,o,n,t)?[]:[st(r,n)]}))}function lc(e,n,t,r,o){var u,c,l,a,f=gt(e).rows,s=N(n,(function(e){return cc(f,e,r)})),m=D(e,(function(e){return yi(e.cells)})),d=(u=s,z(c=m,i)&&yi(u)?y:function(e,n,t){return!("th"===Ye(e.element)&&c[n])}),g=(l=t,a=m,function(e,n){return q.some(oc(l,e.element,"row",a[n]))});return ic(e,s,r,o,uc,g,d)}function ac(e,n,t,r){var o=gt(e).rows;return ic(e,D(n,(function(e){return st(o[e.row],e.column)})),t,r,uc,q.none,y)}function fc(e){return B(e,(function(e,n){return x(e,(function(e){return e.column===n.column}))?e:e.concat([n])}),[]).sort((function(e,n){return e.column-n.column}))}function sc(e){return"tr"===Ye(e)||Ka(e)}function mc(e){return{element:e,colspan:Kn(e,"colspan",1),rowspan:Kn(e,"rowspan",1)}}function dc(e){return Nn(e,"scope").map((function(e){return e.substr(0,3)}))}function gc(e){return n=e,t=Ya.property().name(n),T(Xa,t);var n,t}function pc(e){return n=e,T(["ol","ul"],Ya.property().name(n));var n}function bc(e){function n(e){return"br"===Ye(e)}function t(e){return jo(e).bind((function(t){var r=cn(t).map((function(e){return!!gc(e)||(n=e,!!T(["br","img","hr","input"],Ya.property().name(n))&&"img"!==Ye(e));var n})).getOr(!1);return rn(t).map((function(o){return!0===r||"li"===Ye(u=o)||Dn(u,pc).isSome()||n(t)||gc(o)&&!ce(e,o)?[]:[Ve.fromTag("br")];var u}))})).getOr([])}var r,o=0===(r=N(e,(function(e){var r=ln(e);return z(r,(function(e){return n(e)||pn(e)&&0===Et(e).trim().length}))?[]:r.concat(t(e))}))).length?[Ve.fromTag("br")]:r;Bt(e[0]),It(e[0],o)}function hc(e){return Nu(e,!0)}function vc(e){0===nt(e).length&&Yt(e)}function wc(e,n){return{grid:e,cursor:n}}function yc(e,n,t){var r,o,u,i,c,l=(r=n,o=t,c=gt(e).rows,q.from(null===(i=null===(u=c[r])||void 0===u?void 0:u.cells[o])||void 0===i?void 0:i.element).filter(hc).orThunk((function(){return H(c,(function(e){return H(e.cells,(function(e){var n=e.element;return jn(hc(n),n)}))}))})));return wc(e,l)}function Cc(e){return B(e,(function(e,n){return x(e,(function(e){return e.row===n.row}))?e:e.concat([n])}),[]).sort((function(e,n){return e.row-n.row}))}function Sc(e,n){return function(t,r,o,u,c){return yc(function(e,n,t,r,o,u,c){var l=gt(e),a=l.cols,f=l.rows,s=f[n[0]],m=N(n,(function(e){return r=o,N((n=f)[t=e].cells,(function(e,o){return rc(n,t,o,r)?[]:[e]}));var n,t,r})),d=D(s.cells,(function(e,n){return yi(cc(f,n,o))})),g=X([],f,!0);O(n,(function(e){g[e]=c.transformRow(f[e],t)}));var p,b,h,v,w=a.concat(g),C=(p=s,z(b=d,i)&&yi(p.cells)?y:function(e,n,t){return!("th"===Ye(e.element)&&b[t])}),S=(h=r,v=d,function(e,n,t){return q.some(oc(h,e.element,"col",v[t]))});return ic(w,m,o,u,c.transformCell,S,C)}(t,D(Cc(r),(function(e){return e.row})),e,n,o,u.replaceOrInit,c),r[0].row,r[0].column)}}function Tc(e,n,t){var r,o=(r=t.section,ut(e,(function(){return r})));return Mi($t.generate(o),n,!0)}function xc(e,n,t,r){var o=r.sizing,u=$t.generate(n);lu(u,o.getWidths(u,o),o)}function Rc(e,n,t,r){var o=t,u=r.sizing,i=r.resize,c=$t.generate(n),l=u.getWidths(c,u),a=u.pixelWidth(),f=i.calcRedestributedWidths(l,a,o.pixelDelta,u.isRelative),s=f.newSizes,m=f.delta;lu(c,s,u),u.adjustTableWidth(m)}function Dc(e,n){return x(n,(function(e){return 0===e.column&&e.isLocked}))}function Oc(e,n){return x(n,(function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked}))}function Ac(e,n){var t=yr(e);return B(fc(n),(function(e,n){return e+t[n.column].map(wr).getOr(0)}),0)}function kc(e){return function(n,t){return _i(n,t).filter((function(t){return!(e?Dc:Oc)(n,t)})).map((function(e){return{details:e,pixelDelta:Ac(n,e)}}))}}function Ic(e){return function(n,t){return Li(n,t).filter((function(t){return!(e?Dc:Oc)(n,t.cells)}))}}function Bc(e,n){var t=$t.fromTable(e);return _i(t,n).bind((function(e){var n=e[e.length-1],r=e[0].column,o=n.column+n.colspan,u=P(D(t.all,(function(e){return k(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return ja(u)})).getOr("")}function Mc(e,n){return _i($t.fromTable(e),n).bind(ja).getOr("")}function Ec(e,n,t){function r(e){return"table"===Ye(Yo(e))}function u(t,r,o,u,c){return function(l,a,f){void 0===f&&(f=!1),nu(l);var s=u(),m=Ve.fromDom(e.getDoc()),d=$o(o,m,i),g={sizing:di(e,l),resize:(ai(e)?du:gu)(),section:function(n){switch(ii(e)){case"section":return Fa();case"sectionCells":return Ha();case"cells":return Va();default:return function(e,n){switch(H($t.fromTable(e).all,(function(e){var n=Ci(e);return"header"===n.type?q.from(n.subType):q.none()})).getOr(n)){case"section":return xi();case"sectionCells":return Ri();case"cells":return Di()}}(n,"section")}}(l)};return r(l)?t(s,l,a,d,g).bind((function(t){O(t.newRows,(function(n){qu(e,n.dom)})),O(t.newCells,(function(n){Uu(e,n.dom)}));var r,o=(r=l,t.cursor.fold((function(){return j(nt(r)).filter(Sn).map((function(t){n.clear(r);var o=e.dom.createRng();return o.selectNode(t.dom),e.selection.setRng(o),Mn(t,"data-mce-selected","1"),o}))}),(function(t){var o=La(_a,t),u=e.dom.createRng();return u.setStart(o.element.dom,o.offset),u.setEnd(o.element.dom,o.offset),e.selection.setRng(u),n.clear(r),q.some(u)})));return Sn(l)&&(nu(l),f||Gu(e,l.dom,c)),o.map((function(e){return{rng:e,effect:c}}))})):q.none()}}var i=fi(e),c=ai(e)?o:wi;return{deleteRow:u(lf,(function(n){return!1===r(e)||1<yu(n).rows}),o,t,Sa),deleteColumn:u(cf,(function(n){return!1===r(e)||1<yu(n).columns}),o,t,Sa),insertRowsBefore:u(tf,y,o,t,Sa),insertRowsAfter:u(rf,y,o,t,Sa),insertColumnsBefore:u(of,y,c,t,Sa),insertColumnsAfter:u(uf,y,c,t,Sa),mergeCells:u(bf,y,o,t,Sa),unmergeCells:u(hf,y,o,t,Sa),pasteColsBefore:u(wf,y,o,t,Sa),pasteColsAfter:u(yf,y,o,t,Sa),pasteRowsBefore:u(Cf,y,o,t,Sa),pasteRowsAfter:u(Sf,y,o,t,Sa),pasteCells:u(vf,y,o,t,Ta),makeCellsHeader:u(gf,y,o,t,Sa),unmakeCellsHeader:u(pf,y,o,t,Sa),makeColumnsHeader:u(af,y,o,t,Sa),unmakeColumnsHeader:u(ff,y,o,t,Sa),makeRowsHeader:u(sf,y,o,t,Sa),makeRowsBody:u(mf,y,o,t,Sa),makeRowsFooter:u(df,y,o,t,Sa),getTableRowType:Tf,getTableCellType:Mc,getTableColType:Bc}}function Pc(e,n,t,r){return R(e,(function(e){return function(e,n,t,r){for(var o=Ve.fromTag("tr"),u=0;u<e;u++){var i=r<n||u<t?Ve.fromTag("th"):Ve.fromTag("td");u<t&&Mn(i,"scope","row"),r<n&&Mn(i,"scope","col"),Xt(i,Ve.fromTag("br")),Xt(o,i)}return o}(n,t,r,e)}))}function Nc(e,n){e.selection.select(n.dom,!0),e.selection.collapse(!0)}function zc(e,n,t,r,o){var u=Qu(e),i={styles:u,attributes:Ju(e),colGroups:e.getParam("table_use_colgroups",!1,"boolean")};return e.undoManager.ignore((function(){var u=function(e,n,t,r,o,u){void 0===u&&(u=xf);var i,c,l=Ve.fromTag("table"),a="cells"!==o;qn(l,u.styles),En(l,u.attributes),u.colGroups&&Xt(l,(i=n,c=Ve.fromTag("colgroup"),R(i,(function(){return Xt(c,Ve.fromTag("col"))})),c));var f,s=Math.min(e,t);a&&0<t&&(f=Ve.fromTag("thead"),Xt(l,f),It(f,Pc(t,n,"sectionCells"===o?s:0,r)));var m=Ve.fromTag("tbody");return Xt(l,m),It(m,Pc(a?e-s:e,n,a?0:t,r)),l}(t,n,o,r,ii(e),i);Mn(u,"data-mce-id","__mce");var c,l,a,f=(c=u,l=Ve.fromTag("div"),a=Ve.fromDom(c.dom.cloneNode(!0)),Xt(l,a),l.dom.innerHTML);e.insertContent(f),e.addVisual()})),kn(Yo(e),'table[data-mce-id="__mce"]').map((function(n){var t,r,o;return ka(e)?Ma(n):Ia(e)?Ea(n):(ui(e)||(t=u.width,l(t)&&-1!==t.indexOf("%")))&&Ba(n),nu(n),Wt(n,"data-mce-id"),r=e,O(dn(n,"tr"),(function(e){qu(r,e.dom),O(dn(e,"th,td"),(function(e){Uu(r,e.dom)}))})),o=e,kn(n,"td,th").each(b(Nc,o)),n.dom})).getOr(null)}function Lc(e,n,t,r,o){function u(e){return p(e)&&0<e}if(void 0===r&&(r={}),u(n)&&u(t)){var i=r.headerRows||0;return zc(e,t,n,r.headerColumns||0,i)}return console.error(o),null}function _c(e){return function(){return e().fold((function(){return[]}),(function(e){return D(e,(function(e){return e.dom}))}))}}function Wc(e){return function(n){var t=0<n.length?q.some(Xo(n)):q.none();e(t)}}function jc(e,n,t){var r=Kn(e,n,1);1===t||r<=1?Wt(e,n):Mn(e,n,Math.min(t,r))}function Fc(e,n,t){return function(n,r){for(var o=0;o<r.length;o++){var u=e.getStyle(r[o],t);if((n=void 0===n?u:n)!==u)return""}return n}(void 0,e.select("td,th",n))}function Hc(e,n,t){t&&e.formatter.apply("align"+t,{},n)}function Vc(e,n){Rf.each("left center right".split(" "),(function(t){e.formatter.remove("align"+t,{},n)}))}function qc(e){return Of.test(t=e)||Af.test(t)?q.some({value:(Ae(n=e,"#")?n.substring("#".length):n).toUpperCase()}):q.none();var n,t}function Uc(e){var n=e.toString(16);return(1===n.length?"0"+n:n).toUpperCase()}function Gc(e){return{value:Uc(e.red)+Uc(e.green)+Uc(e.blue)}}function $c(e,n,t,r){return{red:e,green:n,blue:t,alpha:r}}function Kc(e,n,t,r){return $c(parseInt(e,10),parseInt(n,10),parseInt(t,10),parseFloat(r))}function Xc(e){var n=e;return{get:function(){return n},set:function(e){n=e}}}function Yc(e){function n(){return t.get().each(e)}var t=Xc(q.none());return{clear:function(){n(),t.set(q.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(q.some(e))}}}function Jc(){var e=Yc(o);return K(K({},e),{on:function(n){return e.get().each(n)}})}function Qc(e){return be(e,"menu")}function Zc(e,n){return function(t){var r;e.execCommand("mceTableApplyCellStyle",!1,((r={})[n]=t,r))}}function el(e,n,t,r,o){return function(u){return u(Mf(e,n,t,r,o))}}function nl(e,n,t){var r=D(n,(function(e){return{text:e.title,value:"#"+qc(n=e.value).orThunk((function(){return function(e){if("transparent"===e)return q.some($c(0,0,0,0));var n=kf.exec(e);if(null!==n)return q.some(Kc(n[1],n[2],n[3],"1"));var t=If.exec(e);return null!==t?q.some(Kc(t[1],t[2],t[3],t[4])):q.none()}(n).map(Gc)})).getOrThunk((function(){var e=document.createElement("canvas");e.height=1,e.width=1;var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=n,t.fillRect(0,0,1,1);var r=t.getImageData(0,0,1,1).data;return Gc($c(r[0],r[1],r[2],r[3]))})).value,type:"choiceitem"};var n}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<r.length?r:void 0,allowCustomColors:!1},onAction:function(n){var r,o="remove"===n.value?"":n.value;e.execCommand("mceTableApplyCellStyle",!1,((r={})[t]=o,r))}}]}function tl(e){return function(){var n=e.queryCommandValue("mceTableRowType");e.execCommand("mceTableRowType",!1,{type:"header"===n?"body":"header"})}}function rl(e){return function(){var n=e.queryCommandValue("mceTableColType");e.execCommand("mceTableColType",!1,{type:"th"===n?"td":"th"})}}function ol(e){return Pf.concat((0<(n=Bf(ri(e))).length?q.some({name:"class",type:"listbox",label:"Class",items:n}):q.none()).toArray());var n}function ul(e,n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(Bf(Yu(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}}function il(e){return function(n,t){var r=n.dom;return{setAttrib:function(n,o){e&&!o||r.setAttrib(t,n,o)},setStyle:function(n,o){e&&!o||r.setStyle(t,n,o)},setFormat:function(r,o){e&&!o||(""===o?n.formatter.remove(r,{value:null},t,!0):n.formatter.apply(r,{value:o},t))}}}}function cl(e){return function(n){return Ae(n,"rgb")?e.toHex(n):n}}function ll(e,n){var t=Ve.fromDom(n);return{borderwidth:Gn(t,"border-width").getOr(""),borderstyle:Gn(t,"border-style").getOr(""),bordercolor:Gn(t,"border-color").map(cl(e)).getOr(""),backgroundcolor:Gn(t,"background-color").map(cl(e)).getOr("")}}function al(e){var n=e[0];return O(e.slice(1),(function(e){O(Ue(n),(function(t){ae(e,(function(e,r){var o=n[t];""!==o&&t===r&&o!==e&&(n[t]="")}))}))})),n}function fl(e,n,t,r){return M(e,(function(e){return!d(t.formatter.matchNode(r,n+e))})).getOr("")}function sl(e,n){var t=$t.fromTable(e);return D(k($t.justCells(t),(function(e){return x(n,(function(n){return ce(e.element,n)}))})),(function(e){return{element:e.element.dom,column:$t.getColumnAt(t,e.column).map((function(e){return e.element.dom}))}}))}function ml(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u=e,i=n,c=t,l=se(r=o,(function(e,n){return c[n]!==e}));0<ge(l)&&1<=i.length&&rt(i[0]).each((function(e){var n,t,o,c=sl(e,i),a=0<ge(se(l,(function(e,n){return"scope"!==n&&"celltype"!==n}))),f=Ke(l,"celltype");(a||Ke(l,"scope"))&&(n=u,t=r,o=1===c.length,O(c,(function(e){var r,u,i,c,l,a,f=e.element,s=o?Nf.normal(n,f):Nf.ifTruthy(n,f),m=e.column.map((function(e){return o?Nf.normal(n,e):Nf.ifTruthy(n,e)})).getOr(s),d=t;(r=s).setAttrib("scope",d.scope),r.setAttrib("class",d.class),r.setStyle("height",eu(d.height)),m.setStyle("width",eu(d.width)),Zu(n)&&((u=s).setFormat("tablecellbackgroundcolor",(i=t).backgroundcolor),u.setFormat("tablecellbordercolor",i.bordercolor),u.setFormat("tablecellborderstyle",i.borderstyle),u.setFormat("tablecellborderwidth",eu(i.borderwidth))),o&&(Vc(n,f),c=n,l=f,Rf.each("top middle bottom".split(" "),(function(e){c.formatter.remove("valign"+e,{},l)}))),t.halign&&Hc(n,f,t.halign),!t.valign||(a=t.valign)&&n.formatter.apply("valign"+a,{},f)}))),f&&u.execCommand("mceTableCellType",!1,{type:r.celltype,no_events:!0}),Gu(u,e.dom,{structure:f,style:a})})),e.focus()}))}function dl(e,n){var t,r,o,u,i,c=Ql(n);0!==c.length&&(r=e,t=al(rt((o=c)[0]).map((function(e){return D(sl(e,o),(function(e){return t=r,o=e.element,u=Zu(r),i=e.column,c=t.dom,l=i.getOr(o),K({width:n(l,"width"),height:n(o,"height"),scope:c.getAttrib(o,"scope"),celltype:o.nodeName.toLowerCase(),class:c.getAttrib(o,"class",""),halign:zf(t,o),valign:Lf(t,o)},u?ll(c,o):{});function n(e,n){return c.getStyle(e,n)||c.getAttrib(e,n)}var t,o,u,i,c,l}))})).getOrDie()),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:ol(e)},ul(e,"cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:ol(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Zu(e)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:b(ml,e,c,t)}))}function gl(e){return _f.concat((0<(n=Bf(e.getParam("table_row_class_list",[],"array"))).length?q.some({name:"class",type:"listbox",label:"Class",items:n}):q.none()).toArray());var n}function pl(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u,i,c,l,a,f,s=e,m=n,d=t,g=se(r=o,(function(e,n){return d[n]!==e}));0<ge(g)&&(u=Ke(g,"type"),(i=!u||1<ge(g))&&(c=s,l=r,a=d,f=1===m.length,O(m,(function(e){var n,t,r,o=f?Nf.normal(c,e):Nf.ifTruthy(c,e),u=l;(n=o).setAttrib("class",u.class),n.setStyle("height",eu(u.height)),ei(c)&&((t=o).setStyle("background-color",(r=l).backgroundcolor),t.setStyle("border-color",r.bordercolor),t.setStyle("border-style",r.borderstyle)),l.align!==a.align&&(Vc(c,e),Hc(c,e,l.align))}))),u&&s.execCommand("mceTableRowType",!1,{type:r.type,no_events:!0}),rt(Ve.fromDom(m[0])).each((function(e){return Gu(s,e.dom,{structure:u,style:i})}))),e.focus()}))}function bl(e){var n,t,r,o,u,i,c,l=(n=tu(e),t=Xl.selected,o=(r=Jl(n)).bind((function(e){return rt(e)})).map(ot),Wn(r,o,(function(e,n){return k(n,(function(n){return x(Xo(n.dom.cells),(function(n){return"1"===Pn(n,t)||ce(n,e)}))}))})).getOr([]));0!==l.length&&(u=al(D(l,(function(n){return t=e,r=n.dom,o=ei(e),i=t.dom,K({height:i.getStyle(r,"height")||i.getAttrib(r,"height"),class:i.getAttrib(r,"class",""),type:rt(Ve.fromDom(u=r)).map((function(e){var n={selection:Xo(u.cells)};return Tf(e,n)})).getOr(""),align:zf(t,r)},o?ll(i,r):{});var t,r,o,u,i}))),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:gl(e)},ul(e,"row")]},c={type:"panel",items:[{type:"grid",columns:2,items:gl(e)}]},e.windowManager.open({title:"Row Properties",size:"normal",body:ei(e)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onSubmit:b(pl,e,D(l,(function(e){return e.dom})),u)}))}function hl(e,n,t,r){var o=e.dom,u=r.getData(),i=se(u,(function(e,n){return t[n]!==e}));r.close(),""===u.class&&delete u.class,e.undoManager.transact((function(){var t,r,c,l,a;n||(t=parseInt(u.cols,10)||1,r=parseInt(u.rows,10)||1,n=zc(e,t,r,0,0)),0<ge(i)&&(function(e,n,t){var r,o=e.dom,u={},i={};if(u.class=t.class,i.height=eu(t.height),o.getAttrib(n,"width")&&!ti(e)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=eu(t.width),ti(e)?(i["border-width"]=eu(t.border),i["border-spacing"]=eu(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),ti(e)&&n.children)for(var c=0;c<n.children.length;c++)Wf(o,n.children[c],{"border-width":eu(t.border),padding:eu(t.cellpadding)}),ni(e)&&Wf(o,n.children[c],{"border-color":t.bordercolor});ni(e)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(K(K({},Qu(e)),i)),o.setAttribs(n,K(K({},Ju(e)),u))}(e,n,u),((c=o.select("caption",n)[0])&&!u.caption||!c&&u.caption)&&e.execCommand("mceTableToggleCaption"),""===u.align?Vc(e,n):Hc(e,n,u.align)),e.focus(),e.addVisual(),0<ge(i)&&(a=!(l=Ke(i,"caption"))||1<ge(i),Gu(e,n,{structure:l,style:a}))}))}function vl(e,n){var t,r,o,u,i,c,l,a,f,s,m,d,g,p,h,v,w,y,C,S=e.dom,T=(o=ni(r=e),a=Qu(r),f=Ju(r),s=o?(u=r.dom,{borderstyle:pe(a,"border-style").getOr(""),bordercolor:cl(u)(pe(a,"border-color").getOr("")),backgroundcolor:cl(u)(pe(a,"background-color").getOr(""))}):{},K(K(K(K(K(K({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),f),s),(l=a["border-width"],ti(r)&&l?{border:l}:pe(f,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(i=pe(a,"border-spacing").or(pe(f,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),c=pe(a,"border-padding").or(pe(f,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),K(K({},i),c))));!1===n?(t=S.getParent(e.selection.getStart(),"table",e.getBody()))?(d=t,g=ni(m=e),w=m.dom,y=ti(m)?w.getStyle(d,"border-spacing")||w.getAttrib(d,"cellspacing"):w.getAttrib(d,"cellspacing")||w.getStyle(d,"border-spacing"),C=ti(m)?Fc(w,d,"padding")||w.getAttrib(d,"cellpadding"):w.getAttrib(d,"cellpadding")||Fc(w,d,"padding"),T=K({width:w.getStyle(d,"width")||w.getAttrib(d,"width"),height:w.getStyle(d,"height")||w.getAttrib(d,"height"),cellspacing:y,cellpadding:C,border:(p=w,v=Gn(Ve.fromDom(h=d),"border-width"),ti(m)&&v.isSome()?v.getOr(""):p.getAttrib(h,"border")||Fc(m.dom,h,"border-width")||Fc(m.dom,h,"border")),caption:!!w.select("caption",d)[0],class:w.getAttrib(d,"class",""),align:zf(m,d)},g?ll(w,d):{})):ni(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""):(T.cols="1",T.rows="1",ni(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""));var x=Bf(oi(e));0<x.length&&T.class&&(T.class=T.class.replace(/\s*mce\-item\-table\s*/g,""));var R,D,O,A,k={type:"grid",columns:2,items:(R=x,D=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],O=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],A=0<R.length?[{type:"listbox",name:"class",label:"Class",items:R}]:[],D.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(O).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(A))},I=ni(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[k]},ul(e,"table")]}:{type:"panel",items:[k]};e.windowManager.open({title:"Table Properties",size:"normal",body:I,onSubmit:b(hl,e,t,T),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:T})}function wl(e){return Yl(tu(e),Zo(e))}function yl(e,n,t,r,u){function i(e){return rt(e,v)}function c(n){return Jl(tu(t=e),Zo(t)).bind((function(e){return i(e).map((function(t){return n(t,e)}))}));var t}function f(n){e.focus()}function s(e,n){return void 0===n&&(n=!1),c((function(t,o){var u=ou(r,t,o);e(t,u,n).each(f)}))}function m(){return c((function(n,t){var u,i,c,l=ou(r,n,t),a=$o(o,Ve.fromDom(e.getDoc()),q.none());return u=l,i=a,_i(c=$t.fromTable(n),u).bind((function(e){var n=Ei(N(gt(Mi(c,i,!1)).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),(function(e){var n=k(e.cells,(function(e){return!e.isLocked}));return 0<n.length?[K(K({},e),{cells:n})]:[]})));return jn(0<n.length,n)})).map((function(e){return D(e,(function(e){var n=ar(e.element);return O(e.cells,(function(e){var t=fr(e.element);Oi(t,"colspan",e.colspan,1),Oi(t,"rowspan",e.rowspan,1),Xt(n,t)})),n}))}))}))}function d(){return c((function(e,n){var t,o,u=ou(r,e,n);return t=u,Wi(o=$t.fromTable(e),t).map((function(e){var n,t,r=e[e.length-1],u=e[0].column,i=r.column+r.colspan,c=function(e,n,t){if($t.hasColumns(e)){var r=D(k($t.justColumns(e),(function(e){return e.column>=n&&e.column<t})),(function(e){var r=fr(e.element);return jc(r,"span",t-n),r})),o=Ve.fromTag("colgroup");return It(o,r),[o]}return[]}(o,u,i),l=(n=u,t=i,D(o.all,(function(e){var r=D(k(e.cells,(function(e){return e.column>=n&&e.column<t})),(function(e){var r=fr(e.element);return jc(r,"colspan",t-n),r})),o=Ve.fromTag("tr");return It(o,r),o})));return X(X([],c,!0),l,!0)}))}))}function g(n,t){return t().each((function(t){var o=D(t,fr);c((function(t,u){var i,c,l=Ko(Ve.fromDom(e.getDoc())),a=(i=o,c=l,{selection:ru(r),clipboard:i,generators:c});n(t,a).each(f)}))}))}function p(e){return function(n,t){return pe(t,"type").each((function(n){s(e(n),t.no_events)}))}}var v=Zo(e);ae({mceTableSplitCells:function(){return s(n.unmergeCells)},mceTableMergeCells:function(){return s(n.mergeCells)},mceTableInsertRowBefore:function(){return s(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(n.insertRowsAfter)},mceTableInsertColBefore:function(){return s(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(n.insertColumnsAfter)},mceTableDeleteCol:function(){return s(n.deleteColumn)},mceTableDeleteRow:function(){return s(n.deleteRow)},mceTableCutCol:function(){return d().each((function(e){u.setColumns(e),s(n.deleteColumn)}))},mceTableCutRow:function(){return m().each((function(e){u.setRows(e),s(n.deleteRow)}))},mceTableCopyCol:function(){return d().each((function(e){return u.setColumns(e)}))},mceTableCopyRow:function(){return m().each((function(e){return u.setRows(e)}))},mceTablePasteColBefore:function(){return g(n.pasteColsBefore,u.getColumns)},mceTablePasteColAfter:function(){return g(n.pasteColsAfter,u.getColumns)},mceTablePasteRowBefore:function(){return g(n.pasteRowsBefore,u.getRows)},mceTablePasteRowAfter:function(){return g(n.pasteRowsAfter,u.getRows)},mceTableDelete:function(){return wl(e).each((function(n){rt(n,v).filter(h(v)).each((function(n){var t,r=Ve.fromText("");Dt(n,r),Yt(n),e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):((t=e.dom.createRng()).setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged())}))}))},mceTableCellToggleClass:function(n,t){c((function(n){var o=Ql(r),u=z(o,(function(n){return e.formatter.match("tablecellclass",{value:t},n.dom)}))?e.formatter.remove:e.formatter.apply;O(o,(function(e){return u("tablecellclass",{value:t},e.dom)})),Gu(e,n.dom,Ca)}))},mceTableToggleClass:function(n,t){c((function(n){e.formatter.toggle("tableclass",{value:t},n.dom),Gu(e,n.dom,Ca)}))},mceTableToggleCaption:function(){wl(e).each((function(n){rt(n,v).each((function(t){An(t,"caption").fold((function(){var n,r,o=Ve.fromTag("caption");Xt(o,Ve.fromText("Caption")),r=o,an(n=t,0).fold((function(){Xt(n,r)}),(function(e){Rt(e,r)})),e.selection.setCursorLocation(o.dom,0)}),(function(r){en("caption")(n)&&ie("td",t).each((function(n){return e.selection.setCursorLocation(n.dom,0)})),Yt(r)})),Gu(e,t.dom,Sa)}))}))},mceTableSizingMode:function(n,t){return r=t,wl(e).each((function(n){Ia(e)||ka(e)||ui(e)||rt(n,v).each((function(n){"relative"!==r||Bl(n)?"fixed"!==r||Ml(n)?"responsive"!==r||El(n)||Ea(n):Ma(n):Ba(n),nu(n),Gu(e,n.dom,Sa)}))}));var r},mceTableCellType:p((function(e){return"th"===e?n.makeCellsHeader:n.unmakeCellsHeader})),mceTableColType:p((function(e){return"th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader})),mceTableRowType:p((function(e){switch(e){case"header":return n.makeRowsHeader;case"footer":return n.makeRowsFooter;default:return n.makeRowsBody}}))},(function(n,t){return e.addCommand(t,n)})),ae({mceTableProps:b(vl,e,!1),mceTableRowProps:b(bl,e),mceTableCellProps:b(dl,e,r)},(function(n,t){return e.addCommand(t,(function(){return n()}))})),e.addCommand("mceInsertTable",(function(n,t){a(t)&&0<Ue(t).length?Lc(e,t.rows,t.columns,t.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):vl(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(n,t){function o(e){return"tablecell"+e.toLowerCase().replace("-","")}var u,c;!a(t)||0!==(u=Ql(r)).length&&(function(e){for(var n in e)if(Ge.call(e,n))return;return 1}(c=se(t,(function(n,t){return e.formatter.has(o(t))&&l(n)})))||(ae(c,(function(n,t){O(u,(function(r){Nf.normal(e,r.dom).setFormat(o(t),n)}))})),i(u[0]).each((function(n){return Gu(e,n.dom,Ca)}))))}))}function Cl(e,n){return rt(e,n).bind((function(n){var t=nt(n);return E(t,(function(n){return ce(e,n)})).map((function(e){return{index:e,all:t}}))}))}function Sl(e,n){var t=e.document.createRange();return t.selectNode(n.dom),t}function Tl(e,n){var t=e.document.createRange();return Jf(t,n),t}function xl(e,n,t){var r,o=e.document.createRange(),u=o;return n.fold((function(e){u.setStartBefore(e.dom)}),(function(e,n){u.setStart(e.dom,n)}),(function(e){u.setStartAfter(e.dom)})),r=o,t.fold((function(e){r.setEndBefore(e.dom)}),(function(e,n){r.setEnd(e.dom,n)}),(function(e){r.setEndAfter(e.dom)})),o}function Rl(e,n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u}function Dl(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function Ol(e,n,t){return n(Ve.fromDom(t.startContainer),t.startOffset,Ve.fromDom(t.endContainer),t.endOffset)}function Al(e,n){var t,r,o,i=(t=e,n.match({domRange:function(e){return{ltr:u(e),rtl:q.none}},relative:function(e,n){return{ltr:Y((function(){return xl(t,e,n)})),rtl:Y((function(){return q.some(xl(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:Y((function(){return Rl(t,e,n,r,o)})),rtl:Y((function(){return q.some(Rl(t,r,o,e,n))}))}}}));return(o=(r=i).ltr()).collapsed?r.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return Qf.rtl(Ve.fromDom(e.endContainer),e.endOffset,Ve.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return Ol(0,Qf.ltr,o)})):Ol(0,Qf.ltr,o)}function kl(e,n){return Al(e,n).match({ltr:function(n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u},rtl:function(n,t,r,o){var u=e.document.createRange();return u.setStart(r.dom,o),u.setEnd(n.dom,t),u}})}function Il(e,n){return{parent:u(q.from(e.dom.documentElement).map(Ve.fromDom).getOr(e)),view:u(e),origin:u(uo(0,0)),isResizable:n}}function Bl(e){return yo(e).exists((function(e){return _l.test(e)}))}function Ml(e){return yo(e).exists((function(e){return Wl.test(e)}))}function El(e){return yo(e).isNone()}function Pl(){return{transformRow:i,transformCell:Si}}function Nl(e,n){function t(t){if(sc(t))return Ka((u={element:t}).element)?e.colgroup(u):e.row(u);var o,u,i=(o=n(t),$a(o.element)?e.col(o):e.cell(o));return r=q.some({item:t,replacement:i}),i}void 0===n&&(n=mc);var r=q.none();return{getOrInit:function(e,n){return r.fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.replacement:t(e)}))}}}function zl(e){return function(n){function t(t){var o=n.replace(t,e,"td"===e?{scope:null}:{});return r.push({item:t,sub:o}),o}var r=[];return{replaceOrInit:function(e,n){return sc(e)||$a(e)?e:(o=e,u=n,M(r,(function(e){return u(e.item,o)})).fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.sub:t(e)})));var o,u}}}}function Ll(e){return{unmerge:function(n){var t=dc(n);return t.each((function(e){return Mn(n,"scope",e)})),function(){var r=e.cell({element:n,colspan:1,rowspan:1});return $n(r,"width"),$n(n,"width"),t.each((function(e){return Mn(r,"scope",e)})),r}},merge:function(e){return $n(e[0],"width"),function(){var n=_n(D(e,dc));if(0===n.length)return q.none();var t=n[0],r=["row","col"];return x(n,(function(e){return e!==t&&T(r,e)}))?q.none():q.from(t)}().fold((function(){return Wt(e[0],"scope")}),(function(n){return Mn(e[0],"scope",n+"group")})),u(e[0])}}}var _l=/(\d+(\.\d+)?)%/,Wl=/(\d+(\.\d+)?)px|em/,jl=en("col"),Fl=u(_l),Hl=en("col"),Vl=function(e){return yo(e).fold((function(){return t=Eo(n=e,vr),r=u(0),{width:t,pixelWidth:t,getWidths:function(e,t){return Bo(e,n,t)},getCellDelta:r,singleColumnWidth:u([0]),minCellWidth:r,setElementWidth:o,adjustTableWidth:o,isRelative:!0,label:"none"};var n,t,r}),(function(n){return t=e,r=n,(null!==Fl().exec(r)?Po:No)(t);var t,r}))},ql=No,Ul=Po,Gl=["img","br"],$l=function(e,n){var t=function(e){for(var r=ln(e),o=r.length-1;0<=o;o--){var u=r[o];if(n(u))return q.some(u);var i=t(u);if(i.isSome())return i}return q.none()};return t(e)},Kl={scope:["row","col"]},Xl={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Yl=uu("th,td,caption"),Jl=uu("th,td"),Ql=ru,Zl=Lr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),ea=K({},Zl),na=mu((function(e){return e<0})),ta=mu(y),ra=Lr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),oa=K(K({},ra),{from:function(e){return ee(e,"%")?pu("%",ra.percent,e):ee(e,"px")?pu("px",ra.pixels,e):ra.invalid(e)}}),ua=function(e){if(0===e.length)return e;var n,t,r=I(e,(function(e,n){var t=oa.from(n).fold((function(){return{value:n,remainder:0}}),(function(e){return n=e,{value:(t=Math.floor(n))+"px",remainder:n-t};var n,t}),(function(e){return{value:e+"%",remainder:0}}));return{output:[t.value].concat(e.output),remainder:e.remainder+t.remainder}}),{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(n=o[o.length-1],t=Math.round(r.remainder),oa.from(n).fold(u(n),(function(e){return e+t+"px"}),(function(e){return e+t+"%"})))])},ia=oa.from,ca=Ru(["compare","extract","mutate","sink"]),la=Ru(["element","start","stop","destroy"]),aa=Ru(["forceDrop","drop","move","delayDrop"]),fa=function(e,n,t,r){e.dom.removeEventListener(n,t,r)},sa=y,ma=Ou,da=Eu("ephox-dragster").resolve,ga=ca({compare:function(e,n){return uo(n.left-e.left,n.top-e.top)},extract:function(e){return q.some(uo(e.x,e.y))},sink:function(e,n){var t,r,o,i=(t=n,r=K({layerClass:da("blocker")},t),Mn(o=Ve.fromTag("div"),"role","presentation"),qn(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Bu(o,da("blocker")),Bu(o,r.layerClass),{element:u(o),destroy:function(){Yt(o)}}),c=Au(i.element(),"mousedown",e.forceDrop),l=Au(i.element(),"mouseup",e.drop),a=Au(i.element(),"mousemove",e.move),f=Au(i.element(),"mouseout",e.delayDrop);return la({element:i.element,start:function(e){Xt(e,i.element())},stop:function(){Yt(i.element())},destroy:function(){i.destroy(),l.unbind(),a.unbind(),f.unbind(),c.unbind()}})},mutate:function(e,n){e.mutate(n.left,n.top)}}),pa=function(e){return e.dom.contentEditable},ba=Eu("ephox-snooker").resolve,ha=ba("resizer-bar"),va=ba("resizer-rows"),wa=ba("resizer-cols"),ya=ba("resizer-bar-dragging"),Ca={structure:!1,style:!0},Sa={structure:!0,style:!1},Ta={structure:!0,style:!0},xa={"border-collapse":"collapse",width:"100%"},Ra=R(5,(function(e){var n=e+1+"px";return{title:n,value:n}})),Da=D(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),Oa={border:"1"},Aa="preservetable",ka=function(e){return"fixed"===$u(e)||!1===Ku(e)},Ia=function(e){return"responsive"===$u(e)},Ba=function(e){var n=Ro(e);wu(e,q.some(n),q.none()),gi(e)},Ma=function(e){var n=vr(e)+"px";wu(e,q.some(n),q.none()),gi(e)},Ea=function(e){$n(e,"width");var n=tt(e);O(0<n.length?n:nt(e),(function(e){$n(e,"width"),gi(e)})),gi(e)},Pa="bar-",Na=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind((function(n){return Na(e,n,t).orThunk((function(){return q.some(n)}))})):q.none()},za=function(e,n){var t=Na(e,n,e.query().prevSibling).getOr(n);if(e.property().isText(t))return hi(t,vi(e,t));var r=e.property().children(t);return 0<r.length?za(e,r[r.length-1]):hi(t,vi(e,t))},La=za,_a=Zt(),Wa=en("th"),ja=function(e){var n=k(e,(function(e){return Wa(e.element)}));return 0===n.length?q.some("td"):n.length===e.length?q.some("th"):q.none()},Fa=xi,Ha=Ri,Va=Di,qa=function(e){return{isValue:y,isError:w,getOr:u(e),getOrThunk:u(e),getOrDie:u(e),or:function(n){return qa(e)},orThunk:function(n){return qa(e)},fold:function(n,t){return t(e)},map:function(n){return qa(n(e))},mapError:function(n){return qa(e)},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOptional:function(){return q.some(e)}}},Ua=function(e){return{isValue:w,isError:y,getOr:i,getOrThunk:function(e){return e()},getOrDie:function(){return n=String(e),function(){throw new Error(n)}();var n},or:i,orThunk:function(e){return e()},fold:function(n,t){return n(e)},map:function(n){return Ua(e)},mapError:function(n){return Ua(n(e))},each:o,bind:function(n){return Ua(e)},exists:w,forall:y,toOptional:q.none}},Ga={value:qa,error:Ua,fromOption:function(e,n){return e.fold((function(){return Ua(n)}),qa)}},$a=en("col"),Ka=en("colgroup"),Xa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ya=Zt(),Ja=Sc("thead",!0),Qa=Sc("tbody",!1),Za=Sc("tfoot",!1),ef=zl("th"),nf=zl("td"),tf=zi((function(e,n,t,r){var o=n[0].row;return yc(I(Cc(n),(function(e,n){return{grid:nc(e.grid,o,n.row+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o,n[0].column)}),_i,o,o,Nl),rf=zi((function(e,n,t,r){var o=Cc(n),u=o[o.length-1],i=u.row+u.rowspan;return yc(I(o,(function(e,n){return nc(e,i,n.row,t,r.getOrInit)}),e),i,n[0].column)}),_i,o,o,Nl),of=zi((function(e,n,t,r){var o=n.details,u=fc(o),i=u[0].column;return yc(I(u,(function(e,n){return{grid:tc(e.grid,i,n.column+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o[0].row,i)}),kc(!0),Rc,o,Nl),uf=zi((function(e,n,t,r){var o=n.details,u=o[o.length-1],i=u.column+u.colspan;return yc(I(fc(o),(function(e,n){return tc(e,i,n.column,t,r.getOrInit)}),e),o[0].row,i)}),kc(!1),Rc,o,Nl),cf=zi((function(e,n,t,r){var o,u,i=fc(n.details),c=(o=e,u=D(i,(function(e){return e.column})),N(o,(function(e){var n=e.cells,t=I(u,(function(e,n){return 0<=n&&n<e.length?e.slice(0,n).concat(e.slice(n+1)):e}),n);return 0<t.length?[ye(e.element,t,e.section,e.isNew)]:[]}))),l=0<c.length?c[0].cells.length-1:0;return yc(c,i[0].row,Math.min(i[0].column,l))}),(function(e,n){return Wi(e,n).map((function(n){return{details:n,pixelDelta:-Ac(e,n)}}))}),Rc,vc,Nl),lf=zi((function(e,n,t,r){var o,u,i,c,l=Cc(n),a=(o=l[0].row,u=l[l.length-1].row,c=(i=gt(e)).rows,i.cols.concat(c.slice(0,o)).concat(c.slice(u+1))),f=0<a.length?a.length-1:0;return yc(a,Math.min(n[0].row,f),n[0].column)}),_i,o,vc,Nl),af=zi((function(e,n,t,r){return yc(lc(e,D(fc(n),(function(e){return e.column})),!0,t,r.replaceOrInit),n[0].row,n[0].column)}),Wi,o,o,ef),ff=zi((function(e,n,t,r){return yc(lc(e,D(fc(n),(function(e){return e.column})),!1,t,r.replaceOrInit),n[0].row,n[0].column)}),Wi,o,o,nf),sf=zi(Ja,Wi,o,o,ef),mf=zi(Qa,Wi,o,o,nf),df=zi(Za,Wi,o,o,nf),gf=zi((function(e,n,t,r){return yc(ac(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),Wi,o,o,ef),pf=zi((function(e,n,t,r){return yc(ac(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),Wi,o,o,nf),bf=zi((function(e,n,t,r){var o=n.cells;return bc(o),wc(function(e,n,t){var r=gt(e).rows;if(0===r.length)return e;for(var o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++){var i=r[o],c=st(i,u).isLocked;ft(i,u,we(t(),!1,c))}return e}(e,n.bounds,r.merge(o)),q.from(o[0]))}),Fi,xc,o,Ll),hf=zi((function(e,n,t,r){return wc(I(n,(function(e,n){return Vi(e,n,t,r.unmerge(n))}),e),q.from(n[0]))}),Hi,xc,o,Ll),vf=zi((function(e,n,t,r){var o,u,i=(o=n.clipboard,u=n.generators,Mi($t.fromTable(o),u,!0));return Qi({row:n.row,column:n.column},e,i,n.generators,t).fold((function(){return wc(e,q.some(n.element))}),(function(e){return yc(e,n.row,n.column)}))}),(function(e,n){return et(n.element).bind((function(t){return Pi(e,t).map((function(e){return K(K({},e),{generators:n.generators,clipboard:n.clipboard})}))}))}),xc,o,Nl),wf=zi((function(e,n,t,r){var o=gt(e).rows,u=n.cells[0].column,i=o[n.cells[0].row];return yc(Zi(u,e,Tc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Ic(!0),o,o,Nl),yf=zi((function(e,n,t,r){var o=gt(e).rows,u=n.cells[n.cells.length-1].column+n.cells[n.cells.length-1].colspan,i=o[n.cells[0].row];return yc(Zi(u,e,Tc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Ic(!1),o,o,Nl),Cf=zi((function(e,n,t,r){var o=gt(e).rows,u=n.cells[0].row,i=o[u];return yc(ec(u,e,Tc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Li,o,o,Nl),Sf=zi((function(e,n,t,r){var o=gt(e).rows,u=n.cells[n.cells.length-1].row+n.cells[n.cells.length-1].rowspan,i=o[n.cells[0].row];return yc(ec(u,e,Tc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Li,o,o,Nl),Tf=function(e,n){var t=$t.fromTable(e);return _i(t,n).bind((function(e){var n=e[e.length-1],r=e[0].row,o=n.row+n.rowspan;return function(){var e=D(t.all.slice(r,o),(function(e){return Ci(e).type})),n=T(e,"header"),u=T(e,"footer");if(n||u){var i=T(e,"body");return!n||i||u?n||i||!u?q.none():q.some("footer"):q.some("header")}return q.some("body")}()})).getOr("")},xf={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Rf=tinymce.util.Tools.resolve("tinymce.util.Tools"),Df=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],Of=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Af=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,kf=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,If=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Bf=function(e){return D(e,(function(e){var n=e.text||e.title;return Qc(e)?{text:n,items:Bf(e.menu)}:{text:n,value:e.value}}))},Mf=function(e,n,t,r,o){return D(t,(function(t){var u,i,c,l,a=t.text||t.title;return Qc(t)?{type:"nestedmenuitem",text:a,getSubmenuItems:function(){return Mf(e,n,t.menu,r,o)}}:{text:a,type:"togglemenuitem",onAction:function(){return o(t.value)},onSetup:(u=e,i=n,c=r,l=t.value,function(e){function n(){function n(e){return u.formatter.match(c,{value:l},e.dom,r)}var o=Ql(i);r?(e.setActive(!x(o,n)),t.set(u.formatter.formatChanged(c,(function(n){return e.setActive(!n)}),!0))):(e.setActive(z(o,n)),t.set(u.formatter.formatChanged(c,e.setActive,!1,{value:l})))}var t=Yc((function(e){return e.unbind()})),r=!ne(l);return u.initialized?n():u.on("init",n),t.clear})}}))},Ef=function(e){return N(e,(function(e){return Qc(e)?[K(K({},e),{menu:Ef(e.menu)})]:ne(e.value)?[e]:[]}))},Pf=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Df}],Nf={normal:il(!1),ifTruthy:il(!0)},zf=b(fl,["left","center","right"],"align"),Lf=b(fl,["top","middle","bottom"],"valign"),_f=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Wf=function(e,n,t,r){if("TD"===n.tagName||"TH"===n.tagName)l(t)?e.setStyle(n,t,r):e.setStyle(n,t);else if(n.children)for(var o=0;o<n.children.length;o++)Wf(e,n.children[o],t,r)},jf={remove_similar:!0,inherit:!1},Ff=K({selector:"td,th"},jf),Hf={tablecellbackgroundcolor:K({styles:{backgroundColor:"%value"}},Ff),tablecellverticalalign:K({styles:{"vertical-align":"%value"}},Ff),tablecellbordercolor:K({styles:{borderColor:"%value"}},Ff),tablecellclass:K({classes:["%value"]},Ff),tableclass:K({selector:"table",classes:["%value"]},jf),tablecellborderstyle:K({styles:{borderStyle:"%value"}},Ff),tablecellborderwidth:K({styles:{borderWidth:"%value"}},Ff)},Vf=Lr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),qf=K(K({},Vf),{none:function(e){return Vf.none(e=void 0===e?void 0:e)}}),Uf=function(e,n,t,r,o){void 0===o&&(o=y);var u=1===r;if(!u&&t<=0)return qf.first(e[0]);if(u&&t>=e.length-1)return qf.last(e[e.length-1]);var i=t+r,c=e[i];return o(c)?qf.middle(n,c):Uf(e,n,i,r,o)},Gf=function(e,n,t,r){return{start:e,soffset:n,finish:t,foffset:r}},$f=Lr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Kf={before:$f.before,on:$f.on,after:$f.after,cata:function(e,n,t,r){return e.fold(n,t,r)},getStart:function(e){return e.fold(i,i,i)}},Xf=Lr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Yf={domRange:Xf.domRange,relative:Xf.relative,exact:Xf.exact,exactFromRange:function(e){return Xf.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var n=e.match({domRange:function(e){return Ve.fromDom(e.startContainer)},relative:function(e,n){return Kf.getStart(e)},exact:function(e,n,t,r){return e}});return Ve.fromDom(tn(n).dom.defaultView)},range:Gf},Jf=function(e,n){return e.selectNodeContents(n.dom)},Qf=Lr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function Zf(e,n,t){return n>=e.left&&n<=e.right&&t>=e.top&&t<=e.bottom}function es(e,n,t,r,o){function u(t){var r=e.dom.createRange();return r.setStart(n.dom,t),r.collapse(!0),r}var i=Et(n).length,c=function(e,n,t,r){if(0===r)return 0;if(e===t)return r-1;for(var o=t,i=1;i<r;i++){var c=u(i).getBoundingClientRect(),l=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||o<l)return i-1;o=l}}return 0}(t,r,o.right,i);return u(c)}function ns(e,n){return n-e.left<e.right-n}function ts(e,n,t){var r=e.dom.createRange();return r.selectNode(n.dom),r.collapse(t),r}function rs(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var o=ns(r.getBoundingClientRect(),t);return(!0===o?Wo:jo)(n).map((function(n){return ts(e,n,o)}))}function os(e,n,t){var r=ns(n.dom.getBoundingClientRect(),t);return q.some(ts(e,n,r))}function us(e,n){var t=Ye(e);return"input"===t?Kf.after(e):T(["br","img"],t)?0===n?Kf.before(e):Kf.after(e):Kf.on(e,n)}function is(e,n){var t=e.fold(Kf.before,us,Kf.after),r=n.fold(Kf.before,us,Kf.after);return Yf.relative(t,r)}function cs(e,n,t,r){var o=us(e,n),u=us(t,r);return Yf.relative(o,u)}function ls(e){return q.from(e.getSelection())}function as(e,n){ls(e).each((function(e){e.removeAllRanges(),e.addRange(n)}))}function fs(e,n,t,r,o){as(e,Rl(e,n,t,r,o))}function ss(e,n){return Al(e,n).match({ltr:function(n,t,r,o){fs(e,n,t,r,o)},rtl:function(n,t,r,o){ls(e).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(n.dom,t,r.dom,o);else if(u.extend)try{c=r,l=o,(i=u).collapse(n.dom,t),i.extend(c.dom,l)}catch(u){fs(e,r,o,n,t)}else fs(e,r,o,n,t);var i,c,l}))}})}function ms(e,n,t,r,o){ss(e,cs(n,t,r,o))}function ds(e,n,t){ss(e,is(n,t))}function gs(e){if(0<e.rangeCount){var n=e.getRangeAt(0),t=e.getRangeAt(e.rangeCount-1);return q.some(Gf(Ve.fromDom(n.startContainer),n.startOffset,Ve.fromDom(t.endContainer),t.endOffset))}return q.none()}function ps(e){if(null===e.anchorNode||null===e.focusNode)return gs(e);var n,t,r,o,u,i,c,l,a,f,s,m=Ve.fromDom(e.anchorNode),d=Ve.fromDom(e.focusNode);return n=m,t=e.anchorOffset,r=d,o=e.focusOffset,i=t,c=r,l=o,(a=nn(u=n).dom.createRange()).setStart(u.dom,i),a.setEnd(c.dom,l),f=a,s=ce(n,r)&&t===o,f.collapsed&&!s?q.some(Gf(m,e.anchorOffset,d,e.focusOffset)):gs(e)}function bs(e,n,t){as(e,((t=void 0===t||t)?Tl:Sl)(e,n))}function hs(e){return ls(e).filter((function(e){return 0<e.rangeCount})).bind(ps).map((function(e){return Yf.exact(e.start,e.soffset,e.finish,e.foffset)}))}function vs(e,n,t){return Zs(e,n,(o=Nu,Cl(r=t,void 0).fold((function(){return qf.none(r)}),(function(e){return Uf(e.all,r,e.index,1,o)}))));var r,o}function ws(e,n){var t=kl(e,n);return Gf(Ve.fromDom(t.startContainer),t.startOffset,Ve.fromDom(t.endContainer),t.endOffset)}function ys(e,n){return{item:e,mode:n}}function Cs(e,n,t,r){return void 0===r&&(r=Ks),e.property().parent(n).map((function(e){return ys(e,r)}))}function Ss(e){return function(n){return 0===e.property().children(n).length}}function Ts(e,n){return am(sm,e,Ss(sm),n)}function xs(e,n){return fm(sm,e,Ss(sm),n)}function Rs(e){return In(e,"tr")}function Ds(e){return"br"===Ye(e)}function Os(e,n,t,r){var o,u,i,c,l,a,f;return(Ds(n)?(o=e,(i=r).traverse(u=n).orThunk((function(){return pm(u,i.gather,o)})).map(i.relative)):(c=e,l=r,an(a=n,f=t).filter(Ds).orThunk((function(){return an(a,f-1).filter(Ds)})).bind((function(e){return l.traverse(e).fold((function(){return pm(e,l.gather,c).map(l.relative)}),(function(e){return rn(n=e).bind((function(e){var t=ln(e);return gm(t,n).map((function(r){return{parent:e,children:t,element:n,index:r}}))})).map((function(e){return Kf.on(e.parent,e.index)}));var n}))})))).map((function(e){return{start:e,finish:e}}))}function As(e,n){return{left:e.left,top:e.top+n,right:e.right,bottom:e.bottom+n}}function ks(e,n){return{left:e.left,top:e.top-n,right:e.right,bottom:e.bottom-n}}function Is(e,n,t){return{left:e.left+n,top:e.top+t,right:e.right+n,bottom:e.bottom+t}}function Bs(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function Ms(e,n){return q.some(e.getRect(n))}function Es(e,n,t){return gn(n)?Ms(e,n).map(Bs):pn(n)?(r=e,o=n,(0<=(u=t)&&u<Lo(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):q.none()).map(Bs)):q.none();var r,o,u}function Ps(e,n){return gn(n)?Ms(e,n).map(Bs):pn(n)?e.getRangedRect(n,0,n,Lo(n)).map(Bs):q.none()}function Ns(e,n,t){return Rn((function(e,n){return n(e)}),Dn,n,gc,void 0).fold(w,(function(n){return Ps(e,n).exists((function(e){return(n=t).left<(r=e).left||Math.abs(r.right-n.left)<1||n.left>r.right;var n,r}))}))}function zs(e,n,t){var r,o=e.move(t,5),u=vm(n,e,t,o,100).getOr(o),i=u,c=n;return((r=e).point(i)>c.getInnerHeight()?q.some(r.point(i)-c.getInnerHeight()):r.point(i)<0?q.some(-r.point(i)):q.none()).fold((function(){return n.situsFromPoint(u.left,e.point(u))}),(function(t){return n.scrollBy(0,t),n.situsFromPoint(u.left,e.point(u)-t)}))}function Ls(e,n,t,r,o){return In(r,"td,th",n).bind((function(r){return In(r,"table",n).bind((function(u){return a=u,Dn(o,(function(e){return rn(e).exists((function(e){return ce(e,a)}))}),void 0).isSome()?(i=f=e,c=s=n,l=m=t,i.getSelection().bind((function(e){return Os(c,e.finish,e.foffset,l).fold((function(){return q.some(hi(e.finish,e.foffset))}),(function(n){var t=i.fromSitus(n),r=dm.verify(i,e.finish,e.foffset,t.finish,t.foffset,l.failure,c);return dm.cata(r,(function(e){return q.none()}),(function(){return q.none()}),(function(e){return q.some(hi(e,0))}),(function(e){return q.some(hi(e,Lo(e)))}))}))})).bind((function(e){return ym(f,s,e.element,e.offset,m,20).map(f.fromSitus)})).bind((function(e){return In(e.finish,"td,th",n).map((function(n){return{start:r,finish:n,range:e}}))}))):q.none();var i,c,l,a,f,s,m}))}))}function _s(e,n,t,r,o,u){return He().browser.isIE()?q.none():u(r,n).orThunk((function(){return Ls(e,n,t,r,o).map((function(e){var n=e.range;return nm(q.some(rm(n.start,n.soffset,n.finish,n.foffset)),!0)}))}))}function Ws(e,n){return In(e,"tr",n).bind((function(e){return In(e,"table",n).bind((function(t){var r=dn(t,"tr");return ce(e,r[0])?am(sm,t,(function(e){return jo(e).isSome()}),n).map((function(e){var n=Lo(e);return nm(q.some(rm(e,n,e,n)),!0)})):q.none()}))}))}function js(e,n){return In(e,"tr",n).bind((function(e){return In(e,"table",n).bind((function(t){var r=dn(t,"tr");return ce(e,r[r.length-1])?fm(sm,t,(function(e){return Wo(e).isSome()}),n).map((function(e){return nm(q.some(rm(e,0,e,0)),!0)})):q.none()}))}))}function Fs(e,n,t,r,o,u,i){return Ls(e,t,r,o,u).bind((function(e){return om(n,t,e.start,e.finish,i)}))}function Hs(e,n){return In(e,"td,th",n)}function Vs(e){return function(n){return n===e}}function qs(e){return 37<=e&&e<=40}function Us(e){return{elementFromPoint:function(n,t){return Ve.fromPoint(Ve.fromDom(e.document),n,t)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(n,t,r,o){var u,i,c,l=Yf.exact(n,t,r,o);return c=(u=kl(e,l)).getClientRects(),0<(i=0<c.length?c[0]:u.getBoundingClientRect()).width||0<i.height?q.some(i).map(Dl):q.none()},getSelection:function(){return hs(e).map((function(n){return ws(e,n)}))},fromSitus:function(n){var t=Yf.relative(n.start,n.finish);return ws(e,t)},situsFromPoint:function(n,t){return r=n,o=t,u=Ve.fromDom(e.document),Js(u,r,o).map((function(e){return Gf(Ve.fromDom(e.startContainer),e.startOffset,Ve.fromDom(e.endContainer),e.endOffset)})).map((function(e){return tm(e.start,e.soffset,e.finish,e.foffset)}));var r,o,u},clearSelection:function(){ls(e).each((function(e){return e.removeAllRanges()}))},collapseSelection:function(n){void 0===n&&(n=!1),hs(e).each((function(t){return t.fold((function(e){return e.collapse(n)}),(function(t,r){var o=n?t:r;ds(e,o,o)}),(function(t,r,o,u){var i=n?t:o,c=n?r:u;ms(e,i,c,i,c)}))}))},setSelection:function(n){ms(e,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,t){ds(e,n,t)},selectNode:function(n){bs(e,n,!1)},selectContents:function(n){bs(e,n)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n=Ve.fromDom(e.document),t=void 0!==n?n.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return uo(r,o).top},scrollBy:function(n,t){var r,o=n,u=t,i=Ve.fromDom(e.document);(r=(void 0!==i?i.dom:document).defaultView)&&r.scrollBy(o,u)}}}function Gs(e,n){return{rows:e,cols:n}}function $s(e){return!1===Mu(Ve.fromDom(e.target),"ephox-snooker-resizer-bar")}function Ks(e,n,t,r){return void 0===r&&(r=um),t.sibling(e,n).map((function(e){return ys(e,r)}))}function Xs(e,n,t){function r(n){Wt(n,e.selected),Wt(n,e.firstSelected),Wt(n,e.lastSelected)}function o(n){Mn(n,e.selected,"1")}function u(e){i(e),t()}function i(n){O(dn(n,e.selectedSelector+","+e.firstSelectedSelector+","+e.lastSelectedSelector),r)}return{clearBeforeUpdate:i,clear:u,selectRange:function(t,r,i,c){u(t),O(r,o),Mn(i,e.firstSelected,"1"),Mn(c,e.lastSelected,"1"),n(r,i,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}Qf.ltr,Qf.rtl;var Ys=function(e,n,t,r){return pn(n)?(u=n,i=t,c=r,(l=(o=e).dom.createRange()).selectNode(u.dom),H(l.getClientRects(),(function(e){return Zf(e,i,c)?q.some(e):q.none()})).map((function(e){return es(o,u,i,c,e)}))):(f=n,s=t,m=r,d=(a=e).dom.createRange(),H(ln(f),(function(e){return d.selectNode(e.dom),Zf(d.getBoundingClientRect(),s,m)?Ys(a,e,s,m):q.none()})));var o,u,i,c,l,a,f,s,m,d},Js=document.caretPositionFromPoint?function(e,n,t){var r,o;return q.from(null===(o=(r=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,n,t)).bind((function(n){if(null===n.offsetNode)return q.none();var t=e.dom.createRange();return t.setStart(n.offsetNode,n.offset),t.collapse(),q.some(t)}))}:document.caretRangeFromPoint?function(e,n,t){var r,o;return q.from(null===(o=(r=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,n,t))}:function(e,n,t){return Ve.fromPoint(e,n,t).bind((function(r){function o(){return t=e,u=n,(0===ln(o=r).length?os:rs)(t,o,u);var t,o,u}return 0===ln(r).length?o():function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect();return function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return Ys(e,n,i,c)}(e,n,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))}(e,r,n,t).orThunk(o)}))},Qs=tinymce.util.Tools.resolve("tinymce.util.VK"),Zs=function(e,n,t){return t.fold(q.none,q.none,(function(e,n){return Wo(n).map((function(e){return u=Yf.exact(e,0,e,0),t=u,r=Yf.getWin(t).dom,o=t.match({domRange:function(e){var n=Ve.fromDom(e.startContainer),t=Ve.fromDom(e.endContainer);return cs(n,e.startOffset,t,e.endOffset)},relative:is,exact:cs}),Al(r,o).match({ltr:n,rtl:n});function n(e,n,t,o){return Rl(r,e,n,t,o)}var t,r,o,u}))}),(function(t){return e.execCommand("mceTableInsertRowAfter"),vs(e,n,t)}))},em=["table","li","dl"],nm=function(e,n){return{selection:e,kill:n}},tm=function(e,n,t,r){return{start:Kf.on(e,n),finish:Kf.on(t,r)}},rm=tm,om=function(e,n,t,r,o){return ce(t,r)?q.none():tr(t,r,n).bind((function(n){var r=n.boxes.getOr([]);return 1<r.length?(o(e,r,n.start,n.finish),q.some(nm(q.some(rm(t,0,t,Lo(t))),!0))):q.none()}))},um=function(e,n,t,r){void 0===r&&(r=um);var o=e.property().children(n);return t.first(o).map((function(e){return ys(e,r)}))},im=[{current:Cs,next:Ks,fallback:q.none()},{current:Ks,next:um,fallback:q.some(Cs)},{current:um,next:um,fallback:q.some(Ks)}],cm=function(e,n,t,r,o){return M(o=void 0===o?im:o,(function(e){return e.current===t})).bind((function(t){return t.current(e,n,r,t.next).orThunk((function(){return t.fallback.bind((function(t){return cm(e,n,t,r)}))}))}))},lm=function(e,n,t,r,o,u){return cm(e,n,r,o).bind((function(n){return u(n.item)?q.none():t(n.item)?q.some(n.item):lm(e,n.item,t,n.mode,o,u)}))},am=function(e,n,t,r){return lm(e,n,t,Ks,{sibling:function(e,n){return e.query().prevSibling(n)},first:function(e){return 0<e.length?q.some(e[e.length-1]):q.none()}},r)},fm=function(e,n,t,r){return lm(e,n,t,Ks,{sibling:function(e,n){return e.query().nextSibling(n)},first:function(e){return 0<e.length?q.some(e[0]):q.none()}},r)},sm=Zt(),mm=Lr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),dm=K(K({},mm),{verify:function(e,n,t,r,o,u,i){return In(r,"td,th",i).bind((function(t){return In(n,"td,th",i).map((function(n){return ce(t,n)?ce(r,t)&&Lo(t)===o?u(n):mm.none("in same cell"):er(Rs,[t,n]).fold((function(){return o=t,i=(r=e).getRect(n),(c=r.getRect(o)).right>i.left&&c.left<i.right?mm.success():u(n);var r,o,i,c}),(function(e){return u(n)}))}))})).getOr(mm.none("default"))},cata:function(e,n,t,r,o){return e.fold(n,t,r,o)}}),gm=function(e,n){return E(e,b(ce,n))},pm=function(e,n,t){return n(e,t).bind((function(e){return pn(e)&&0===Et(e).trim().length?pm(e,n,t):q.some(e)}))},bm=Lr([{none:[]},{retry:["caret"]}]),hm={point:function(e){return e.bottom},adjuster:function(e,n,t,r,o){var u=As(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?bm.retry(u):t.top===o.bottom?bm.retry(As(o,1)):Ns(e,n,o)?bm.retry(Is(u,5,0)):bm.none()},move:As,gather:xs},vm=function(e,n,t,r,o){return 0===o?q.some(r):(i=e,c=r.left,l=n.point(r),i.elementFromPoint(c,l).filter((function(e){return"table"===Ye(e)})).isSome()?(u=o-1,vm(e,n,t,n.move(r,5),u)):e.situsFromPoint(r.left,n.point(r)).bind((function(u){return u.start.fold(q.none,(function(u){return Ps(e,u).bind((function(i){return n.adjuster(e,u,i,t,r).fold(q.none,(function(r){return vm(e,n,t,r,o-1)}))})).orThunk((function(){return q.some(r)}))}),q.none)})));var u,i,c,l},wm={tryUp:b(zs,{point:function(e){return e.top},adjuster:function(e,n,t,r,o){var u=ks(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?bm.retry(u):t.bottom===o.top?bm.retry(ks(o,1)):Ns(e,n,o)?bm.retry(Is(u,5,0)):bm.none()},move:ks,gather:Ts}),tryDown:b(zs,hm),ieTryUp:function(e,n){return e.situsFromPoint(n.left,n.top-5)},ieTryDown:function(e,n){return e.situsFromPoint(n.left,n.bottom+5)},getJumpSize:u(5)},ym=function(e,n,t,r,o,u){return 0===u?q.none():Tm(e,n,t,r,o).bind((function(i){var c=e.fromSitus(i),l=dm.verify(e,t,r,c.finish,c.foffset,o.failure,n);return dm.cata(l,(function(){return q.none()}),(function(){return q.some(i)}),(function(i){return ce(t,i)&&0===r?Cm(e,t,r,ks,o):ym(e,n,i,0,o,u-1)}),(function(i){return ce(t,i)&&r===Lo(i)?Cm(e,t,r,As,o):ym(e,n,i,Lo(i),o,u-1)}))}))},Cm=function(e,n,t,r,o){return Es(e,n,t).bind((function(n){return Sm(e,o,r(n,wm.getJumpSize()))}))},Sm=function(e,n,t){var r=He().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(e,t):r.isIE()?n.ieRetry(e,t):q.none()},Tm=function(e,n,t,r,o){return Es(e,t,r).bind((function(n){return Sm(e,o,n)}))},xm={traverse:cn,gather:xs,relative:Kf.before,otherRetry:wm.tryDown,ieRetry:wm.ieTryDown,failure:dm.failedDown},Rm={traverse:un,gather:Ts,relative:Kf.before,otherRetry:wm.tryUp,ieRetry:wm.ieTryUp,failure:dm.failedUp},Dm=Vs(38),Om=Vs(40),Am={isBackward:Vs(37),isForward:Vs(39)},km={isBackward:Vs(39),isForward:Vs(37)},Im=tinymce.util.Tools.resolve("tinymce.Env");function Bm(e,n,t){var r=Xs(Xl,(function(n,r,u){t.targets().each((function(t){rt(r).each((function(i){var c,l,a,f=fi(e),s=$o(o,Ve.fromDom(e.getDoc()),f),m=(c=t,l=s,_i(a=$t.fromTable(i),c).map((function(e){var n,t,r=Mi(a,l,!1);return{upOrLeftCells:N(Ei(r.slice(0,(n=e)[n.length-1].row+1)),(function(e){return D(e.cells.slice(0,n[n.length-1].column+1),(function(e){return e.element}))})),downOrRightCells:N(Ei(r.slice((t=e)[0].row+t[0].rowspan-1,r.length)),(function(e){return D(e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length),(function(e){return e.element}))}))}})));e.fire("TableSelectionChange",{cells:n,start:r,finish:u,otherCells:m})}))}))}),(function(){e.fire("TableSelectionClear")}));return e.on("init",(function(t){var u,i,c,l,a,f,s,m,d,g,p,h,v,w,y,C,S=e.getWin(),T=Yo(e),x=Zo(e),R=(u=Us(S),{clearstate:(p=u,h=T,v=x,w=r,y=Jc(),(i={clearstate:C=y.clear,mousedown:function(e){w.clear(h),Hs(e.target,v).each(y.set)},mouseover:function(e){k(e)},mouseup:function(e){k(e),C()}}).clearstate),mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}),D=(g=Us(S),{keydown:function(e,n,t,r,o,u){var i=e.raw,c=i.which,l=!0===i.shiftKey;return rr(s,d.selectedSelector).fold((function(){return qs(c)&&!l&&d.clearBeforeUpdate(s),Om(c)&&l?b(Fs,g,s,m,xm,r,n,d.selectRange):Dm(c)&&l?b(Fs,g,s,m,Rm,r,n,d.selectRange):Om(c)?b(_s,g,m,xm,r,n,js):Dm(c)?b(_s,g,m,Rm,r,n,Ws):q.none}),(function(e){function n(n){return function(){return H(n,(function(n){return t=n.rows,r=n.cols,o=s,ur(e,t,r,(u=d).firstSelectedSelector,u.lastSelectedSelector).map((function(e){return u.clearBeforeUpdate(o),u.selectRange(o,e.boxes,e.start,e.finish),e.boxes}));var t,r,o,u})).fold((function(){return or(s,d.firstSelectedSelector,d.lastSelectedSelector).map((function(e){var n=Om(c)||u.isForward(c)?Kf.after:Kf.before;return g.setRelativeSelection(Kf.on(e.first,0),n(e.table)),d.clear(s),nm(q.none(),!0)}))}),(function(e){return q.some(nm(q.none(),!0))}))}}return Om(c)&&l?n([Gs(1,0)]):Dm(c)&&l?n([Gs(-1,0)]):u.isBackward(c)&&l?n([Gs(0,-1),Gs(-1,0)]):u.isForward(c)&&l?n([Gs(0,1),Gs(1,0)]):qs(c)&&!l?A:q.none}))()},keyup:function(e,n,t,r,o){return rr(s,d.selectedSelector).fold((function(){var u,i,c,l,a,f=e.raw,g=f.which;return!0===f.shiftKey&&qs(g)?(u=s,i=m,a=d.selectRange,ce(c=n,l=r)&&t===o?q.none():In(c,"td,th",i).bind((function(e){return In(l,"td,th",i).bind((function(n){return om(u,i,e,n,a)}))}))):q.none()}),q.none)}}),O=(c=s=T,l=m=x,a=d=r,f=Us(S),function(e,n){a.clearBeforeUpdate(c),tr(e,n,l).each((function(e){var t=e.boxes.getOr([]);a.selectRange(c,t,e.start,e.finish),f.selectContents(n),f.collapseSelection()}))});function A(){return d.clear(s),q.none()}function k(e){y.on((function(n){w.clearBeforeUpdate(h),Hs(e.target,v).each((function(t){tr(n,t,v).each((function(n){var r,o,u,i=n.boxes.getOr([]);1===i.length?(r=i[0],o="false"===pa(r),u=Ln(Pu(e.target),r,ce),o&&u&&(w.selectRange(h,i,r,r),p.selectContents(r))):1<i.length&&(w.selectRange(h,i,n.start,n.finish),p.selectContents(t))}))}))}))}function I(n,t){!0===n.raw.shiftKey&&(t.kill&&n.kill(),t.selection.each((function(n){var t=Yf.relative(n.start,n.finish),r=kl(S,t);e.selection.setRng(r)})))}function B(e){return 0===e.button}e.on("TableSelectorChange",(function(e){return O(e.start,e.finish)}));var M,E,P=(M=Xc(Ve.fromDom(T)),E=Xc(0),{touchEnd:function(e){var n,t,r=Ve.fromDom(e.target);"td"!==Ye(r)&&"th"!==Ye(r)||(n=M.get(),t=E.get(),ce(n,r)&&e.timeStamp-t<300&&(e.preventDefault(),O(r,r))),M.set(r),E.set(e.timeStamp)}});e.on("dragstart",(function(e){R.clearstate()})),e.on("mousedown",(function(e){B(e)&&$s(e)&&R.mousedown(ma(e))})),e.on("mouseover",(function(e){var n;(void 0===(n=e).buttons||Im.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&$s(e)&&R.mouseover(ma(e))})),e.on("mouseup",(function(e){B(e)&&$s(e)&&R.mouseup(ma(e))})),e.on("touchend",P.touchEnd),e.on("keyup",(function(n){var t,r,o,u=ma(n);u.raw.shiftKey&&qs(u.raw.which)&&(t=e.selection.getRng(),r=Ve.fromDom(t.startContainer),o=Ve.fromDom(t.endContainer),D.keyup(u,r,t.startOffset,o,t.endOffset).each((function(e){I(u,e)})))})),e.on("keydown",(function(t){var r=ma(t);n().each((function(e){return e.hideBars()}));var o=e.selection.getRng(),u=Ve.fromDom(o.startContainer),i=Ve.fromDom(o.endContainer),c=Sr(Am,km)(Ve.fromDom(e.selection.getStart()));D.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(e){I(r,e)})),n().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var n=e.selection;er(rt,[Ve.fromDom(n.getStart()),Ve.fromDom(n.getEnd())]).fold((function(){return r.clear(T)}),o)}))})),{clear:r.clear}}function Mm(e,n){function t(e){return g.forall((function(n){return!n[e]}))}function r(){return Yl(tu(e),Zo(e)).bind((function(t){return Wn(rt(t),Yl(Ve.fromDom(e.selection.getEnd()),Zo(e)).bind(rt),(function(e,r){return ce(e,r)?p(t)?q.some({element:o=t,mergable:q.none(),unmergable:q.none(),selection:[o]}):q.some(ou(n,e,t)):q.none();var o})).bind(i)}))}function o(e){return rt(e.element).map((function(n){var t=$t.fromTable(n),r=B(_i(t,e).getOr([]),(function(e,n){return n.isLocked&&(e.onAny=!0,0===n.column?e.onFirst=!0:n.column+n.colspan>=t.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Fi(t,e).isSome(),unmergeable:Hi(t,e).isSome(),locked:r}}))}function u(){m.set(Y(r)()),g=m.get().bind(o),O(d.get(),(function(e){return e()}))}function c(e){return e(),d.set(d.get().concat([e])),function(){d.set(k(d.get(),(function(n){return n!==e})))}}function l(e,n){return c((function(){return m.get().fold((function(){e.setDisabled(!0)}),(function(t){e.setDisabled(n(t))}))}))}function a(e,n,t){return c((function(){return m.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(r){e.setDisabled(n(r)),e.setActive(t(r))}))}))}function f(e){return g.exists((function(n){return n.locked[e]}))}function s(n,t){return function(r){return a(r,(function(e){return p(e.element)}),(function(){return e.queryCommandValue(n)===t}))}}var m=Xc(q.none()),d=Xc([]),g=q.none(),p=en("caption"),b=s("mceTableRowType","header"),h=s("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(e){return l(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return l(e,(function(e){return p(e.element)}))},onSetupColumn:function(e){return function(n){return l(n,(function(n){return p(n.element)||f(e)}))}},onSetupPasteable:function(e){return function(n){return l(n,(function(n){return p(n.element)||e().isNone()}))}},onSetupPasteableColumn:function(e,n){return function(t){return l(t,(function(t){return p(t.element)||e().isNone()||f(n)}))}},onSetupMergeable:function(e){return l(e,(function(e){return t("mergeable")}))},onSetupUnmergeable:function(e){return l(e,(function(e){return t("unmergeable")}))},resetTargets:u,onSetupTableWithCaption:function(n){return a(n,w,(function(n){return rt(n.element,Zo(e)).exists((function(e){return An(e,"caption").isSome()}))}))},onSetupTableRowHeaders:b,onSetupTableColumnHeaders:h,targets:m.get}}Yr.add("table",(function(e){var n,t,r,o,i,c,l,a,f,s,m,d,g=(n=function(){return Yo(e)},t=function(){return Jl(tu(e),Zo(e))},r=Xl.selectedSelector,{get:function(){return Ur(n(),r).fold((function(){return t().fold($r,Xr)}),(function(e){return Kr(e)}))}}),p=Mm(e,g),b=bi(e),h=Bm(e,b.lazyResize,p),v=Ec(e,h,b.lazyWire),w=(o=Jc(),i=Jc(),{getRows:o.get,setRows:function(e){e.fold(o.clear,o.set),i.clear()},clearRows:o.clear,getColumns:i.get,setColumns:function(e){e.fold(i.clear,i.set),o.clear()},clearColumns:i.clear});return yl(e,v,0,g,w),s=v,m=g,d=Zo(f=e),ae({mceTableRowType:function(){return y(s.getTableRowType)},mceTableCellType:function(){return y(s.getTableCellType)},mceTableColType:function(){return y(s.getTableColType)}},(function(e,n){return f.addQueryValueHandler(n,e)})),iu(e,g,v),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}function i(n){e.execCommand("mceInsertTable",!1,{rows:n.numRows,columns:n.numColumns})}var c={text:"Table properties",onSetup:t.onSetupTable,onAction:o("mceTableProps")},l={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)});var a={type:"nestedmenuitem",text:"Row",getSubmenuItems:u("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")});var f={type:"nestedmenuitem",text:"Column",getSubmenuItems:u("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});var s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:u("tablecellprops tablemergecells tablesplitcells")};!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",c),e.ui.registry.addMenuItem("deletetable",l),e.ui.registry.addNestedMenuItem("row",a),e.ui.registry.addNestedMenuItem("column",f),e.ui.registry.addNestedMenuItem("cell",s),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(u(""),(function(e){return"caption"===Ye(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var m=Ef(oi(e));0!==m.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return Mf(e,n,m,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)}))},onSetup:t.onSetupTable});var d=Ef(ri(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return Mf(e,n,d,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)}))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return Mf(e,n,Df,"tablecellverticalalign",Zc(e,"vertical-align"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return Mf(e,n,Xu(e),"tablecellborderwidth",Zc(e,"border-width"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return Mf(e,n,Yu(e),"tablecellborderstyle",Zc(e,"border-style"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:o("mceTableToggleCaption"),onSetup:t.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return nl(e,si(e),"background-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return nl(e,mi(e),"border-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:tl(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:rl(e),onSetup:t.onSetupTableColumnHeaders})}(e,g,p,w),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}}),e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"});var u=Ef(oi(e));0!==u.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:el(e,n,u,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)})),onSetup:t.onSetupTable});var i=Ef(ri(e));0!==i.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:el(e,n,i,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)})),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:el(e,n,Df,"tablecellverticalalign",Zc(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:el(e,n,Xu(e),"tablecellborderwidth",Zc(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:el(e,n,Yu(e),"tablecellborderstyle",Zc(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:o("mceTableToggleCaption"),icon:"table-caption",onSetup:t.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(n){return n(nl(e,si(e),"background-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(n){return n(nl(e,mi(e),"border-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:tl(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:rl(e),onSetup:t.onSetupTableColumnHeaders})}(e,g,p,w),0<(a=(l=e).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&l.ui.registry.addContextToolbar("table",{predicate:function(e){return l.dom.is(e,"table")&&l.getBody().contains(e)},items:a,scope:"node",position:"node"}),e.on("PreInit",(function(){e.serializer.addTempAttr(Xl.firstSelected),e.serializer.addTempAttr(Xl.lastSelected),e.formatter.register(Hf)})),e.getParam("table_tab_navigation",!0,"boolean")&&e.on("keydown",(function(n){var t,r,o,u,i=e,c=h;(t=n).keyCode===Qs.TAB&&(r=Yo(i),o=function(e){var n=Ye(e);return ce(e,r)||T(em,n)},u=i.selection.getRng(),et(Ve.fromDom(t.shiftKey?u.startContainer:u.endContainer),o).each((function(e){t.preventDefault(),rt(e,o).each(c.clear),i.selection.collapse(t.shiftKey),(t.shiftKey?function(e,n,t){return Zs(e,n,(o=Nu,Cl(r=t,void 0).fold((function(){return qf.none()}),(function(e){return Uf(e.all,r,e.index,-1,o)}))));var r,o}:vs)(i,o,e).each((function(e){i.selection.setRng(e)}))})))})),e.on("remove",(function(){b.destroy()})),{insertTable:(c=e,function(e,n,t){var r=Lc(c,n,e,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return c.undoManager.add(),r}),setClipboardRows:Wc(w.setRows),getClipboardRows:_c(w.getRows),setClipboardCols:Wc(w.setColumns),getClipboardCols:_c(w.getColumns),resizeHandler:b,selectionTargets:p};function y(e){return Jl(tu(f)).bind((function(n){return rt(n,d).map((function(t){var r=ou(m,t,n);return e(t,r)}))})).getOr("")}}))}();